/**
 * dijit - A version of dijit.js framework that ported to running on skylarkjs.
 * @author Hudaokeji, Inc.
 * @version v0.9.0
 * @link https://github.com/skylark-integration/dijit/
 * @license MIT
 */
define(["require","dojo/_base/array","dojo/_base/declare","dojo/_base/fx","dojo/dom","dojo/dom-attr","dojo/dom-class","dojo/dom-construct","dojo/dom-geometry","dojo/keys","dojo/_base/lang","dojo/sniff","dojo/topic","../focus","../_base/manager","dojo/ready","../_Widget","../_Container","../_TemplatedMixin","../_CssStateMixin","./StackContainer","./ContentPane","dojo/text!./templates/AccordionButton.html","../a11yclick"],function(require,t,e,i,n,o,d,s,r,a,c,h,l,u,p,_,g,f,W,b,y,C,N){var m=e("dijit.layout._AccordionButton",[g,W,b],{templateString:N,label:"",_setLabelAttr:{node:"titleTextNode",type:"innerHTML"},title:"",_setTitleAttr:{node:"titleTextNode",type:"attribute",attribute:"title"},iconClassAttr:"",_setIconClassAttr:{node:"iconNode",type:"class"},baseClass:"dijitAccordionTitle",getParent:function(){return this.parent},buildRendering:function(){this.inherited(arguments);var t=this.id.replace(" ","_");o.set(this.titleTextNode,"id",t+"_title"),this.focusNode.setAttribute("aria-labelledby",o.get(this.titleTextNode,"id")),n.setSelectable(this.domNode,!1)},getTitleHeight:function(){return r.getMarginSize(this.domNode).h},_onTitleClick:function(){this.getParent().selectChild(this.contentWidget,!0),u.focus(this.focusNode)},_onTitleKeyDown:function(t){return this.getParent()._onKeyDown(t,this.contentWidget)},_setSelectedAttr:function(t){this._set("selected",t),this.focusNode.setAttribute("aria-expanded",t?"true":"false"),this.focusNode.setAttribute("aria-selected",t?"true":"false"),this.focusNode.setAttribute("tabIndex",t?"0":"-1")}});h("dojo-bidi")&&m.extend({_setLabelAttr:function(t){this._set("label",t),o.set(this.titleTextNode,"innerHTML",t),this.applyTextDir(this.titleTextNode)},_setTitleAttr:function(t){this._set("title",t),o.set(this.titleTextNode,"title",t),this.applyTextDir(this.titleTextNode)}});var w=e("dijit.layout._AccordionInnerContainer"+(h("dojo-bidi")?"_NoBidi":""),[g,b],{baseClass:"dijitAccordionInnerContainer",isLayoutContainer:!0,buildRendering:function(){this.domNode=s.place("<div class='"+this.baseClass+"' role='presentation'>",this.contentWidget.domNode,"after");var t=this.contentWidget,e=c.isString(this.buttonWidget)?c.getObject(this.buttonWidget):this.buttonWidget;this.button=t._buttonWidget=new e({contentWidget:t,label:t.title,title:t.tooltip,dir:t.dir,lang:t.lang,textDir:t.textDir||this.textDir,iconClass:t.iconClass,id:t.id+"_button",parent:this.parent}).placeAt(this.domNode),this.containerNode=s.place("<div class='dijitAccordionChildWrapper' role='tabpanel' style='display:none'>",this.domNode),this.containerNode.setAttribute("aria-labelledby",this.button.id),s.place(this.contentWidget.domNode,this.containerNode)},postCreate:function(){this.inherited(arguments);var t=this.button,e=this.contentWidget;this._contentWidgetWatches=[e.watch("title",c.hitch(this,function(e,i,n){t.set("label",n)})),e.watch("tooltip",c.hitch(this,function(e,i,n){t.set("title",n)})),e.watch("iconClass",c.hitch(this,function(e,i,n){t.set("iconClass",n)}))]},_setSelectedAttr:function(t){if(this._set("selected",t),this.button.set("selected",t),t){var e=this.contentWidget;e.onSelected&&e.onSelected()}},startup:function(){this.contentWidget.startup()},destroy:function(){this.button.destroyRecursive(),t.forEach(this._contentWidgetWatches||[],function(t){t.unwatch()}),delete this.contentWidget._buttonWidget,delete this.contentWidget._wrapperWidget,this.inherited(arguments)},destroyDescendants:function(t){this.contentWidget.destroyRecursive(t)}});h("dojo-bidi")&&(w=e("dijit.layout._AccordionInnerContainer",w,{postCreate:function(){this.inherited(arguments);var t=this.button;this._contentWidgetWatches.push(this.contentWidget.watch("textDir",function(e,i,n){t.set("textDir",n)}))}}));var x=e("dijit.layout.AccordionContainer",y,{duration:p.defaultDuration,buttonWidget:m,baseClass:"dijitAccordionContainer",buildRendering:function(){this.inherited(arguments),this.domNode.style.overflow="hidden",this.domNode.setAttribute("role","tablist")},startup:function(){this._started||(this.inherited(arguments),this.selectedChildWidget&&this.selectedChildWidget._wrapperWidget.set("selected",!0))},layout:function(){var e=this.selectedChildWidget;if(e){var i=e._wrapperWidget.domNode,n=r.getMarginExtents(i),o=r.getPadBorderExtents(i),d=e._wrapperWidget.containerNode,s=r.getMarginExtents(d),a=r.getPadBorderExtents(d),c=this._contentBox,h=0;t.forEach(this.getChildren(),function(t){t!=e&&(h+=r.getMarginSize(t._wrapperWidget.domNode).h)}),this._verticalSpace=c.h-h-n.h-o.h-s.h-a.h-e._buttonWidget.getTitleHeight(),this._containerContentBox={h:this._verticalSpace,w:this._contentBox.w-n.w-o.w-s.w-a.w},e&&e.resize(this._containerContentBox)}},_setupChild:function(t){t._wrapperWidget=w({contentWidget:t,buttonWidget:this.buttonWidget,id:t.id+"_wrapper",dir:t.dir,lang:t.lang,textDir:t.textDir||this.textDir,parent:this}),this.inherited(arguments),s.place(t.domNode,t._wrapper,"replace")},removeChild:function(t){t._wrapperWidget&&(s.place(t.domNode,t._wrapperWidget.domNode,"after"),t._wrapperWidget.destroy(),delete t._wrapperWidget),d.remove(t.domNode,"dijitHidden"),this.inherited(arguments)},getChildren:function(){return t.map(this.inherited(arguments),function(t){return"dijit.layout._AccordionInnerContainer"==t.declaredClass?t.contentWidget:t},this)},destroy:function(){this._animation&&this._animation.stop(),t.forEach(this.getChildren(),function(t){t._wrapperWidget?t._wrapperWidget.destroy():t.destroyRecursive()}),this.inherited(arguments)},_showChild:function(t){return t._wrapperWidget.containerNode.style.display="block",this.inherited(arguments)},_hideChild:function(t){t._wrapperWidget.containerNode.style.display="none",this.inherited(arguments)},_transition:function(t,e,n){h("ie")<8&&(n=!1),this._animation&&(this._animation.stop(!0),delete this._animation);var o=this;if(t){t._wrapperWidget.set("selected",!0);var d=this._showChild(t);this.doLayout&&t.resize&&t.resize(this._containerContentBox)}if(e&&(e._wrapperWidget.set("selected",!1),n||this._hideChild(e)),n){var s=t._wrapperWidget.containerNode,a=e._wrapperWidget.containerNode,c=t._wrapperWidget.containerNode,l=r.getMarginExtents(c),u=r.getPadBorderExtents(c),p=l.h+u.h;a.style.height=o._verticalSpace-p+"px",this._animation=new i.Animation({node:s,duration:this.duration,curve:[1,this._verticalSpace-p-1],onAnimate:function(t){t=Math.floor(t),s.style.height=t+"px",a.style.height=o._verticalSpace-p-t+"px"},onEnd:function(){delete o._animation,s.style.height="auto",e._wrapperWidget.containerNode.style.display="none",a.style.height="auto",o._hideChild(e)}}),this._animation.onStop=this._animation.onEnd,this._animation.play()}return d},_onKeyDown:function(t,e){if(!this.disabled&&!t.altKey&&(e||t.ctrlKey)){var i=t.keyCode;e&&(i==a.LEFT_ARROW||i==a.UP_ARROW)||t.ctrlKey&&i==a.PAGE_UP?(this._adjacent(!1)._buttonWidget._onTitleClick(),t.stopPropagation(),t.preventDefault()):(e&&(i==a.RIGHT_ARROW||i==a.DOWN_ARROW)||t.ctrlKey&&(i==a.PAGE_DOWN||i==a.TAB))&&(this._adjacent(!0)._buttonWidget._onTitleClick(),t.stopPropagation(),t.preventDefault())}}});return h("dijit-legacy-requires")&&_(0,function(){require(["dijit/layout/AccordionPane"])}),x._InnerContainer=w,x._Button=m,x});
//# sourceMappingURL=../sourcemaps/layout/AccordionContainer.js.map
