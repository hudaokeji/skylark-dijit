{"version":3,"sources":["layout/AccordionContainer.js"],"names":["define","require","array","declare","fx","dom","domAttr","domClass","domConstruct","domGeometry","keys","lang","has","topic","focus","manager","ready","_Widget","_Container","_TemplatedMixin","_CssStateMixin","StackContainer","ContentPane","template","AccordionButton","templateString","label","_setLabelAttr","node","type","title","_setTitleAttr","attribute","iconClassAttr","_setIconClassAttr","baseClass","getParent","this","parent","buildRendering","inherited","arguments","titleTextNodeId","id","replace","set","titleTextNode","focusNode","setAttribute","get","setSelectable","domNode","getTitleHeight","getMarginSize","h","_onTitleClick","selectChild","contentWidget","_onTitleKeyDown","evt","_onKeyDown","_setSelectedAttr","isSelected","_set","extend","applyTextDir","AccordionInnerContainer","isLayoutContainer","place","child","cls","isString","buttonWidget","getObject","button","_buttonWidget","tooltip","dir","textDir","iconClass","placeAt","containerNode","postCreate","cw","_contentWidgetWatches","watch","hitch","name","oldValue","newValue","onSelected","startup","destroy","destroyRecursive","forEach","w","unwatch","_wrapperWidget","destroyDescendants","preserveDom","push","AccordionContainer","duration","defaultDuration","style","overflow","_started","selectedChildWidget","layout","openPane","wrapperDomNode","wrapperDomNodeMargin","getMarginExtents","wrapperDomNodePadBorder","getPadBorderExtents","wrapperContainerNode","wrapperContainerNodeMargin","wrapperContainerNodePadBorder","mySize","_contentBox","totalCollapsedHeight","getChildren","_verticalSpace","_containerContentBox","resize","_setupChild","_wrapper","removeChild","remove","map","declaredClass","_animation","stop","_showChild","display","_hideChild","_transition","newWidget","oldWidget","animate","self","d","doLayout","newContents","oldContents","animationHeightOverhead","height","Animation","curve","onAnimate","value","Math","floor","onEnd","onStop","play","e","fromTitle","disabled","altKey","ctrlKey","c","keyCode","LEFT_ARROW","UP_ARROW","PAGE_UP","_adjacent","stopPropagation","preventDefault","RIGHT_ARROW","DOWN_ARROW","PAGE_DOWN","TAB","_InnerContainer","_Button"],"mappings":"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","file":"../../layout/AccordionContainer.js","sourcesContent":["define([\r\n\t\"require\",\r\n\t\"dojo/_base/array\", // array.forEach array.map\r\n\t\"dojo/_base/declare\", // declare\r\n\t\"dojo/_base/fx\", // fx.Animation\r\n\t\"dojo/dom\", // dom.setSelectable\r\n\t\"dojo/dom-attr\", // domAttr.attr\r\n\t\"dojo/dom-class\", // domClass.remove\r\n\t\"dojo/dom-construct\", // domConstruct.place\r\n\t\"dojo/dom-geometry\",\r\n\t\"dojo/keys\", // keys\r\n\t\"dojo/_base/lang\", // lang.getObject lang.hitch\r\n\t\"dojo/sniff\", // has(\"ie\") has(\"dijit-legacy-requires\")\r\n\t\"dojo/topic\", // publish\r\n\t\"../focus\", // focus.focus()\r\n\t\"../_base/manager\", // manager.defaultDuration\r\n\t\"dojo/ready\",\r\n\t\"../_Widget\",\r\n\t\"../_Container\",\r\n\t\"../_TemplatedMixin\",\r\n\t\"../_CssStateMixin\",\r\n\t\"./StackContainer\",\r\n\t\"./ContentPane\",\r\n\t\"dojo/text!./templates/AccordionButton.html\",\r\n\t\"../a11yclick\" // AccordionButton template uses ondijitclick; not for keyboard, but for responsive touch.\r\n], function(require, array, declare, fx, dom, domAttr, domClass, domConstruct, domGeometry, keys, lang, has, topic,\r\n\t\t\tfocus, manager, ready, _Widget, _Container, _TemplatedMixin, _CssStateMixin, StackContainer, ContentPane, template){\r\n\r\n\t// module:\r\n\t//\t\tdijit/layout/AccordionContainer\r\n\r\n\r\n\t// Design notes:\r\n\t//\r\n\t// An AccordionContainer is a StackContainer, but each child (typically ContentPane)\r\n\t// is wrapped in a _AccordionInnerContainer.   This is hidden from the caller.\r\n\t//\r\n\t// The resulting markup will look like:\r\n\t//\r\n\t//\t<div class=dijitAccordionContainer>\r\n\t//\t\t<div class=dijitAccordionInnerContainer>\t(one pane)\r\n\t//\t\t\t\t<div class=dijitAccordionTitle>\t\t(title bar) ... </div>\r\n\t//\t\t\t\t<div class=dijtAccordionChildWrapper>   (content pane) </div>\r\n\t//\t\t</div>\r\n\t//\t</div>\r\n\t//\r\n\t// Normally the dijtAccordionChildWrapper is hidden for all but one child (the shown\r\n\t// child), so the space for the content pane is all the title bars + the one dijtAccordionChildWrapper,\r\n\t// which on claro has a 1px border plus a 2px bottom margin.\r\n\t//\r\n\t// During animation there are two dijtAccordionChildWrapper's shown, so we need\r\n\t// to compensate for that.\r\n\r\n\tvar AccordionButton = declare(\"dijit.layout._AccordionButton\", [_Widget, _TemplatedMixin, _CssStateMixin], {\r\n\t\t// summary:\r\n\t\t//\t\tThe title bar to click to open up an accordion pane.\r\n\t\t//\t\tInternal widget used by AccordionContainer.\r\n\t\t// tags:\r\n\t\t//\t\tprivate\r\n\r\n\t\ttemplateString: template,\r\n\r\n\t\t// label: String\r\n\t\t//\t\tTitle of the pane\r\n\t\tlabel: \"\",\r\n\t\t_setLabelAttr: {node: \"titleTextNode\", type: \"innerHTML\" },\r\n\r\n\t\t// title: String\r\n\t\t//\t\tTooltip that appears on hover\r\n\t\ttitle: \"\",\r\n\t\t_setTitleAttr: {node: \"titleTextNode\", type: \"attribute\", attribute: \"title\"},\r\n\r\n\t\t// iconClassAttr: String\r\n\t\t//\t\tCSS class for icon to left of label\r\n\t\ticonClassAttr: \"\",\r\n\t\t_setIconClassAttr: { node: \"iconNode\", type: \"class\" },\r\n\r\n\t\tbaseClass: \"dijitAccordionTitle\",\r\n\r\n\t\tgetParent: function(){\r\n\t\t\t// summary:\r\n\t\t\t//\t\tReturns the AccordionContainer parent.\r\n\t\t\t// tags:\r\n\t\t\t//\t\tprivate\r\n\t\t\treturn this.parent;\r\n\t\t},\r\n\r\n\t\tbuildRendering: function(){\r\n\t\t\tthis.inherited(arguments);\r\n\t\t\tvar titleTextNodeId = this.id.replace(' ', '_');\r\n\t\t\tdomAttr.set(this.titleTextNode, \"id\", titleTextNodeId + \"_title\");\r\n\t\t\tthis.focusNode.setAttribute(\"aria-labelledby\", domAttr.get(this.titleTextNode, \"id\"));\r\n\t\t\tdom.setSelectable(this.domNode, false);\r\n\t\t},\r\n\r\n\t\tgetTitleHeight: function(){\r\n\t\t\t// summary:\r\n\t\t\t//\t\tReturns the height of the title dom node.\r\n\t\t\treturn domGeometry.getMarginSize(this.domNode).h;\t// Integer\r\n\t\t},\r\n\r\n\t\t// TODO: maybe the parent should set these methods directly rather than forcing the code\r\n\t\t// into the button widget?\r\n\t\t_onTitleClick: function(){\r\n\t\t\t// summary:\r\n\t\t\t//\t\tCallback when someone clicks my title.\r\n\t\t\tvar parent = this.getParent();\r\n\t\t\tparent.selectChild(this.contentWidget, true);\r\n\t\t\tfocus.focus(this.focusNode);\r\n\t\t},\r\n\r\n\t\t_onTitleKeyDown: function(/*Event*/ evt){\r\n\t\t\treturn this.getParent()._onKeyDown(evt, this.contentWidget);\r\n\t\t},\r\n\r\n\t\t_setSelectedAttr: function(/*Boolean*/ isSelected){\r\n\t\t\tthis._set(\"selected\", isSelected);\r\n\t\t\tthis.focusNode.setAttribute(\"aria-expanded\", isSelected ? \"true\" : \"false\");\r\n\t\t\tthis.focusNode.setAttribute(\"aria-selected\", isSelected ? \"true\" : \"false\");\r\n\t\t\tthis.focusNode.setAttribute(\"tabIndex\", isSelected ? \"0\" : \"-1\");\r\n\t\t}\r\n\t});\r\n\r\n\tif(has(\"dojo-bidi\")){\r\n\t\tAccordionButton.extend({\r\n\t\t\t_setLabelAttr: function(label){\r\n\t\t\t\tthis._set(\"label\", label);\r\n\t\t\t\tdomAttr.set(this.titleTextNode, \"innerHTML\", label);\r\n\t\t\t\tthis.applyTextDir(this.titleTextNode);\r\n\t\t\t},\r\n\r\n\t\t\t_setTitleAttr: function(title){\r\n\t\t\t\tthis._set(\"title\", title);\r\n\t\t\t\tdomAttr.set(this.titleTextNode, \"title\", title);\r\n\t\t\t\tthis.applyTextDir(this.titleTextNode);\r\n\t\t\t}\r\n\t\t});\r\n\t}\r\n\r\n\tvar AccordionInnerContainer = declare(\"dijit.layout._AccordionInnerContainer\" + (has(\"dojo-bidi\") ? \"_NoBidi\" : \"\"), [_Widget, _CssStateMixin], {\r\n\t\t// summary:\r\n\t\t//\t\tInternal widget placed as direct child of AccordionContainer.containerNode.\r\n\t\t//\t\tWhen other widgets are added as children to an AccordionContainer they are wrapped in\r\n\t\t//\t\tthis widget.\r\n\r\n\t\t/*=====\r\n\t\t // buttonWidget: Function|String\r\n\t\t //\t\tClass to use to instantiate title\r\n\t\t //\t\t(Wish we didn't have a separate widget for just the title but maintaining it\r\n\t\t //\t\tfor backwards compatibility, is it worth it?)\r\n\t\t buttonWidget: null,\r\n\t\t =====*/\r\n\r\n\t\t/*=====\r\n\t\t // contentWidget: dijit/_WidgetBase\r\n\t\t //\t\tPointer to the real child widget\r\n\t\t contentWidget: null,\r\n\t\t =====*/\r\n\r\n\t\tbaseClass: \"dijitAccordionInnerContainer\",\r\n\r\n\t\t// tell nested layout widget that we will take care of sizing\r\n\t\tisLayoutContainer: true,\r\n\r\n\t\tbuildRendering: function(){\r\n\t\t\t// Builds a template like:\r\n\t\t\t//\t<div class=dijitAccordionInnerContainer>\r\n\t\t\t//\t\tButton\r\n\t\t\t//\t\t<div class=dijitAccordionChildWrapper>\r\n\t\t\t//\t\t\tContentPane\r\n\t\t\t//\t\t</div>\r\n\t\t\t//\t</div>\r\n\r\n\t\t\t// Create wrapper div, placed where the child is now\r\n\t\t\tthis.domNode = domConstruct.place(\"<div class='\" + this.baseClass +\r\n\t\t\t\t\"' role='presentation'>\", this.contentWidget.domNode, \"after\");\r\n\r\n\t\t\t// wrapper div's first child is the button widget (ie, the title bar)\r\n\t\t\tvar child = this.contentWidget,\r\n\t\t\t\tcls = lang.isString(this.buttonWidget) ? lang.getObject(this.buttonWidget) : this.buttonWidget;\r\n\t\t\tthis.button = child._buttonWidget = (new cls({\r\n\t\t\t\tcontentWidget: child,\r\n\t\t\t\tlabel: child.title,\r\n\t\t\t\ttitle: child.tooltip,\r\n\t\t\t\tdir: child.dir,\r\n\t\t\t\tlang: child.lang,\r\n\t\t\t\ttextDir: child.textDir || this.textDir,\r\n\t\t\t\ticonClass: child.iconClass,\r\n\t\t\t\tid: child.id + \"_button\",\r\n\t\t\t\tparent: this.parent\r\n\t\t\t})).placeAt(this.domNode);\r\n\r\n\t\t\t// and then the actual content widget (changing it from prior-sibling to last-child),\r\n\t\t\t// wrapped by a <div class=dijitAccordionChildWrapper>\r\n\t\t\tthis.containerNode = domConstruct.place(\"<div class='dijitAccordionChildWrapper' role='tabpanel' style='display:none'>\", this.domNode);\r\n\t\t\tthis.containerNode.setAttribute(\"aria-labelledby\", this.button.id);\r\n\r\n\t\t\tdomConstruct.place(this.contentWidget.domNode, this.containerNode);\r\n\t\t},\r\n\r\n\t\tpostCreate: function(){\r\n\t\t\tthis.inherited(arguments);\r\n\r\n\t\t\t// Map changes in content widget's title etc. to changes in the button\r\n\t\t\tvar button = this.button,\r\n\t\t\t\tcw = this.contentWidget;\r\n\t\t\tthis._contentWidgetWatches = [\r\n\t\t\t\tcw.watch('title', lang.hitch(this, function(name, oldValue, newValue){\r\n\t\t\t\t\tbutton.set(\"label\", newValue);\r\n\t\t\t\t})),\r\n\t\t\t\tcw.watch('tooltip', lang.hitch(this, function(name, oldValue, newValue){\r\n\t\t\t\t\tbutton.set(\"title\", newValue);\r\n\t\t\t\t})),\r\n\t\t\t\tcw.watch('iconClass', lang.hitch(this, function(name, oldValue, newValue){\r\n\t\t\t\t\tbutton.set(\"iconClass\", newValue);\r\n\t\t\t\t}))\r\n\t\t\t];\r\n\t\t},\r\n\r\n\t\t_setSelectedAttr: function(/*Boolean*/ isSelected){\r\n\t\t\tthis._set(\"selected\", isSelected);\r\n\t\t\tthis.button.set(\"selected\", isSelected);\r\n\t\t\tif(isSelected){\r\n\t\t\t\tvar cw = this.contentWidget;\r\n\t\t\t\tif(cw.onSelected){\r\n\t\t\t\t\tcw.onSelected();\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\tstartup: function(){\r\n\t\t\t// Called by _Container.addChild()\r\n\t\t\tthis.contentWidget.startup();\r\n\t\t},\r\n\r\n\t\tdestroy: function(){\r\n\t\t\tthis.button.destroyRecursive();\r\n\r\n\t\t\tarray.forEach(this._contentWidgetWatches || [], function(w){\r\n\t\t\t\tw.unwatch();\r\n\t\t\t});\r\n\r\n\t\t\tdelete this.contentWidget._buttonWidget;\r\n\t\t\tdelete this.contentWidget._wrapperWidget;\r\n\r\n\t\t\tthis.inherited(arguments);\r\n\t\t},\r\n\r\n\t\tdestroyDescendants: function(/*Boolean*/ preserveDom){\r\n\t\t\t// since getChildren isn't working for me, have to code this manually\r\n\t\t\tthis.contentWidget.destroyRecursive(preserveDom);\r\n\t\t}\r\n\t});\r\n\r\n\tif(has(\"dojo-bidi\")){\r\n\t\tAccordionInnerContainer = declare(\"dijit.layout._AccordionInnerContainer\", AccordionInnerContainer, {\r\n\t\t\tpostCreate: function(){\r\n\t\t\t\tthis.inherited(arguments);\r\n\r\n\t\t\t\t// Map changes in content widget's textdir to changes in the button\r\n\t\t\t\tvar button = this.button;\r\n\t\t\t\tthis._contentWidgetWatches.push(\r\n\t\t\t\t\tthis.contentWidget.watch(\"textDir\", function(name, oldValue, newValue){\r\n\t\t\t\t\t\tbutton.set(\"textDir\", newValue);\r\n\t\t\t\t\t})\r\n\t\t\t\t);\r\n\t\t\t}\r\n\t\t});\r\n\t}\r\n\r\n\tvar AccordionContainer = declare(\"dijit.layout.AccordionContainer\", StackContainer, {\r\n\t\t// summary:\r\n\t\t//\t\tHolds a set of panes where every pane's title is visible, but only one pane's content is visible at a time,\r\n\t\t//\t\tand switching between panes is visualized by sliding the other panes up/down.\r\n\t\t// example:\r\n\t\t//\t|\t<div data-dojo-type=\"dijit/layout/AccordionContainer\">\r\n\t\t//\t|\t\t<div data-dojo-type=\"dijit/layout/ContentPane\" title=\"pane 1\">\r\n\t\t//\t|\t\t</div>\r\n\t\t//\t|\t\t<div data-dojo-type=\"dijit/layout/ContentPane\" title=\"pane 2\">\r\n\t\t//\t|\t\t\t<p>This is some text</p>\r\n\t\t//\t|\t\t</div>\r\n\t\t//\t|\t</div>\r\n\r\n\t\t// duration: Integer\r\n\t\t//\t\tAmount of time (in ms) it takes to slide panes\r\n\t\tduration: manager.defaultDuration,\r\n\r\n\t\t// buttonWidget: [const] String\r\n\t\t//\t\tThe name of the widget used to display the title of each pane\r\n\t\tbuttonWidget: AccordionButton,\r\n\r\n\t\t/*=====\r\n\t\t // _verticalSpace: Number\r\n\t\t //\t\tPixels of space available for the open pane\r\n\t\t //\t\t(my content box size minus the cumulative size of all the title bars)\r\n\t\t _verticalSpace: 0,\r\n\t\t =====*/\r\n\t\tbaseClass: \"dijitAccordionContainer\",\r\n\r\n\t\tbuildRendering: function(){\r\n\t\t\tthis.inherited(arguments);\r\n\t\t\tthis.domNode.style.overflow = \"hidden\";\t\t// TODO: put this in dijit.css\r\n\t\t\tthis.domNode.setAttribute(\"role\", \"tablist\");\r\n\t\t},\r\n\r\n\t\tstartup: function(){\r\n\t\t\tif(this._started){\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tthis.inherited(arguments);\r\n\t\t\tif(this.selectedChildWidget){\r\n\t\t\t\tthis.selectedChildWidget._wrapperWidget.set(\"selected\", true);\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\tlayout: function(){\r\n\t\t\t// Implement _LayoutWidget.layout() virtual method.\r\n\t\t\t// Set the height of the open pane based on what room remains.\r\n\r\n\t\t\tvar openPane = this.selectedChildWidget;\r\n\r\n\t\t\tif(!openPane){\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\r\n\t\t\t// space taken up by title, plus wrapper div (with border/margin) for open pane\r\n\t\t\tvar wrapperDomNode = openPane._wrapperWidget.domNode,\r\n\t\t\t\twrapperDomNodeMargin = domGeometry.getMarginExtents(wrapperDomNode),\r\n\t\t\t\twrapperDomNodePadBorder = domGeometry.getPadBorderExtents(wrapperDomNode),\r\n\t\t\t\twrapperContainerNode = openPane._wrapperWidget.containerNode,\r\n\t\t\t\twrapperContainerNodeMargin = domGeometry.getMarginExtents(wrapperContainerNode),\r\n\t\t\t\twrapperContainerNodePadBorder = domGeometry.getPadBorderExtents(wrapperContainerNode),\r\n\t\t\t\tmySize = this._contentBox;\r\n\r\n\t\t\t// get cumulative height of all the unselected title bars\r\n\t\t\tvar totalCollapsedHeight = 0;\r\n\t\t\tarray.forEach(this.getChildren(), function(child){\r\n\t\t\t\tif(child != openPane){\r\n\t\t\t\t\t// Using domGeometry.getMarginSize() rather than domGeometry.position() since claro has 1px bottom margin\r\n\t\t\t\t\t// to separate accordion panes.  Not sure that works perfectly, it's probably putting a 1px\r\n\t\t\t\t\t// margin below the bottom pane (even though we don't want one).\r\n\t\t\t\t\ttotalCollapsedHeight += domGeometry.getMarginSize(child._wrapperWidget.domNode).h;\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t\tthis._verticalSpace = mySize.h - totalCollapsedHeight - wrapperDomNodeMargin.h\r\n\t\t\t\t- wrapperDomNodePadBorder.h - wrapperContainerNodeMargin.h - wrapperContainerNodePadBorder.h\r\n\t\t\t\t- openPane._buttonWidget.getTitleHeight();\r\n\r\n\t\t\t// Memo size to make displayed child\r\n\t\t\tthis._containerContentBox = {\r\n\t\t\t\th: this._verticalSpace,\r\n\t\t\t\tw: this._contentBox.w - wrapperDomNodeMargin.w - wrapperDomNodePadBorder.w\r\n\t\t\t\t\t- wrapperContainerNodeMargin.w - wrapperContainerNodePadBorder.w\r\n\t\t\t};\r\n\r\n\t\t\tif(openPane){\r\n\t\t\t\topenPane.resize(this._containerContentBox);\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\t_setupChild: function(child){\r\n\t\t\t// Overrides _LayoutWidget._setupChild().\r\n\t\t\t// Put wrapper widget around the child widget, showing title\r\n\r\n\t\t\tchild._wrapperWidget = AccordionInnerContainer({\r\n\t\t\t\tcontentWidget: child,\r\n\t\t\t\tbuttonWidget: this.buttonWidget,\r\n\t\t\t\tid: child.id + \"_wrapper\",\r\n\t\t\t\tdir: child.dir,\r\n\t\t\t\tlang: child.lang,\r\n\t\t\t\ttextDir: child.textDir || this.textDir,\r\n\t\t\t\tparent: this\r\n\t\t\t});\r\n\r\n\t\t\tthis.inherited(arguments);\r\n\r\n\t\t\t// Since we are wrapping children in AccordionInnerContainer, replace the default\r\n\t\t\t// wrapper that we created in StackContainer.\r\n\t\t\tdomConstruct.place(child.domNode, child._wrapper, \"replace\");\r\n\t\t},\r\n\r\n\t\tremoveChild: function(child){\r\n\t\t\t// Overrides _LayoutWidget.removeChild().\r\n\r\n\t\t\t// Destroy wrapper widget first, before StackContainer.getChildren() call.\r\n\t\t\t// Replace wrapper widget with true child widget (ContentPane etc.).\r\n\t\t\t// This step only happens if the AccordionContainer has been started; otherwise there's no wrapper.\r\n\t\t\t// (TODO: since StackContainer destroys child._wrapper, maybe it can do this step too?)\r\n\t\t\tif(child._wrapperWidget){\r\n\t\t\t\tdomConstruct.place(child.domNode, child._wrapperWidget.domNode, \"after\");\r\n\t\t\t\tchild._wrapperWidget.destroy();\r\n\t\t\t\tdelete child._wrapperWidget;\r\n\t\t\t}\r\n\r\n\t\t\tdomClass.remove(child.domNode, \"dijitHidden\");\r\n\r\n\t\t\tthis.inherited(arguments);\r\n\t\t},\r\n\r\n\t\tgetChildren: function(){\r\n\t\t\t// Overrides _Container.getChildren() to return content panes rather than internal AccordionInnerContainer panes\r\n\t\t\treturn array.map(this.inherited(arguments), function(child){\r\n\t\t\t\treturn child.declaredClass == \"dijit.layout._AccordionInnerContainer\" ? child.contentWidget : child;\r\n\t\t\t}, this);\r\n\t\t},\r\n\r\n\t\tdestroy: function(){\r\n\t\t\tif(this._animation){\r\n\t\t\t\tthis._animation.stop();\r\n\t\t\t}\r\n\t\t\tarray.forEach(this.getChildren(), function(child){\r\n\t\t\t\t// If AccordionContainer has been started, then each child has a wrapper widget which\r\n\t\t\t\t// also needs to be destroyed.\r\n\t\t\t\tif(child._wrapperWidget){\r\n\t\t\t\t\tchild._wrapperWidget.destroy();\r\n\t\t\t\t}else{\r\n\t\t\t\t\tchild.destroyRecursive();\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t\tthis.inherited(arguments);\r\n\t\t},\r\n\r\n\t\t_showChild: function(child){\r\n\t\t\t// Override StackContainer._showChild() to set visibility of _wrapperWidget.containerNode\r\n\t\t\tchild._wrapperWidget.containerNode.style.display = \"block\";\r\n\t\t\treturn this.inherited(arguments);\r\n\t\t},\r\n\r\n\t\t_hideChild: function(child){\r\n\t\t\t// Override StackContainer._showChild() to set visibility of _wrapperWidget.containerNode\r\n\t\t\tchild._wrapperWidget.containerNode.style.display = \"none\";\r\n\t\t\tthis.inherited(arguments);\r\n\t\t},\r\n\r\n\t\t_transition: function(/*dijit/_WidgetBase?*/ newWidget, /*dijit/_WidgetBase?*/ oldWidget, /*Boolean*/ animate){\r\n\t\t\t// Overrides StackContainer._transition() to provide sliding of title bars etc.\r\n\r\n\t\t\tif(has(\"ie\") < 8){\r\n\t\t\t\t// workaround animation bugs by not animating; not worth supporting animation for IE6 & 7\r\n\t\t\t\tanimate = false;\r\n\t\t\t}\r\n\r\n\t\t\tif(this._animation){\r\n\t\t\t\t// there's an in-progress animation.  speedily end it so we can do the newly requested one\r\n\t\t\t\tthis._animation.stop(true);\r\n\t\t\t\tdelete this._animation;\r\n\t\t\t}\r\n\r\n\t\t\tvar self = this;\r\n\r\n\t\t\tif(newWidget){\r\n\t\t\t\tnewWidget._wrapperWidget.set(\"selected\", true);\r\n\r\n\t\t\t\tvar d = this._showChild(newWidget);\t// prepare widget to be slid in\r\n\r\n\t\t\t\t// Size the new widget, in case this is the first time it's being shown,\r\n\t\t\t\t// or I have been resized since the last time it was shown.\r\n\t\t\t\t// Note that page must be visible for resizing to work.\r\n\t\t\t\tif(this.doLayout && newWidget.resize){\r\n\t\t\t\t\tnewWidget.resize(this._containerContentBox);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tif(oldWidget){\r\n\t\t\t\toldWidget._wrapperWidget.set(\"selected\", false);\r\n\t\t\t\tif(!animate){\r\n\t\t\t\t\tthis._hideChild(oldWidget);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tif(animate){\r\n\t\t\t\tvar newContents = newWidget._wrapperWidget.containerNode,\r\n\t\t\t\t\toldContents = oldWidget._wrapperWidget.containerNode;\r\n\r\n\t\t\t\t// During the animation we will be showing two dijitAccordionChildWrapper nodes at once,\r\n\t\t\t\t// which on claro takes up 4px extra space (compared to stable AccordionContainer).\r\n\t\t\t\t// Have to compensate for that by immediately shrinking the pane being closed.\r\n\t\t\t\tvar wrapperContainerNode = newWidget._wrapperWidget.containerNode,\r\n\t\t\t\t\twrapperContainerNodeMargin = domGeometry.getMarginExtents(wrapperContainerNode),\r\n\t\t\t\t\twrapperContainerNodePadBorder = domGeometry.getPadBorderExtents(wrapperContainerNode),\r\n\t\t\t\t\tanimationHeightOverhead = wrapperContainerNodeMargin.h + wrapperContainerNodePadBorder.h;\r\n\r\n\t\t\t\toldContents.style.height = (self._verticalSpace - animationHeightOverhead) + \"px\";\r\n\r\n\t\t\t\tthis._animation = new fx.Animation({\r\n\t\t\t\t\tnode: newContents,\r\n\t\t\t\t\tduration: this.duration,\r\n\t\t\t\t\tcurve: [1, this._verticalSpace - animationHeightOverhead - 1],\r\n\t\t\t\t\tonAnimate: function(value){\r\n\t\t\t\t\t\tvalue = Math.floor(value);\t// avoid fractional values\r\n\t\t\t\t\t\tnewContents.style.height = value + \"px\";\r\n\t\t\t\t\t\toldContents.style.height = (self._verticalSpace - animationHeightOverhead - value) + \"px\";\r\n\t\t\t\t\t},\r\n\t\t\t\t\tonEnd: function(){\r\n\t\t\t\t\t\tdelete self._animation;\r\n\t\t\t\t\t\tnewContents.style.height = \"auto\";\r\n\t\t\t\t\t\toldWidget._wrapperWidget.containerNode.style.display = \"none\";\r\n\t\t\t\t\t\toldContents.style.height = \"auto\";\r\n\t\t\t\t\t\tself._hideChild(oldWidget);\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t\tthis._animation.onStop = this._animation.onEnd;\r\n\t\t\t\tthis._animation.play();\r\n\t\t\t}\r\n\r\n\t\t\treturn d;\t// If child has an href, promise that fires when the widget has finished loading\r\n\t\t},\r\n\r\n\t\t// note: we are treating the container as controller here\r\n\t\t_onKeyDown: function(/*Event*/ e, /*dijit/_WidgetBase*/ fromTitle){\r\n\t\t\t// summary:\r\n\t\t\t//\t\tHandle keydown events\r\n\t\t\t// description:\r\n\t\t\t//\t\tThis is called from a handler on AccordionContainer.domNode\r\n\t\t\t//\t\t(setup in StackContainer), and is also called directly from\r\n\t\t\t//\t\tthe click handler for accordion labels\r\n\t\t\tif(this.disabled || e.altKey || !(fromTitle || e.ctrlKey)){\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tvar c = e.keyCode;\r\n\t\t\tif((fromTitle && (c == keys.LEFT_ARROW || c == keys.UP_ARROW)) ||\r\n\t\t\t\t(e.ctrlKey && c == keys.PAGE_UP)){\r\n\t\t\t\tthis._adjacent(false)._buttonWidget._onTitleClick();\r\n\t\t\t\te.stopPropagation();\r\n\t\t\t\te.preventDefault();\r\n\t\t\t}else if((fromTitle && (c == keys.RIGHT_ARROW || c == keys.DOWN_ARROW)) ||\r\n\t\t\t\t(e.ctrlKey && (c == keys.PAGE_DOWN || c == keys.TAB))){\r\n\t\t\t\tthis._adjacent(true)._buttonWidget._onTitleClick();\r\n\t\t\t\te.stopPropagation();\r\n\t\t\t\te.preventDefault();\r\n\t\t\t}\r\n\t\t}\r\n\t});\r\n\r\n\t// Back compat w/1.6, remove for 2.0\r\n\tif(has(\"dijit-legacy-requires\")){\r\n\t\tready(0, function(){\r\n\t\t\tvar requires = [\"dijit/layout/AccordionPane\"];\r\n\t\t\trequire(requires);\t// use indirection so modules not rolled into a build\r\n\t\t});\r\n\t}\r\n\r\n\t// For monkey patching\r\n\tAccordionContainer._InnerContainer = AccordionInnerContainer;\r\n\tAccordionContainer._Button = AccordionButton;\r\n\r\n\treturn AccordionContainer;\r\n});\r\n"]}