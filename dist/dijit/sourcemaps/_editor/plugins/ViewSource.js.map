{"version":3,"sources":["_editor/plugins/ViewSource.js"],"names":["define","array","aspect","declare","domAttr","domConstruct","domGeometry","domStyle","i18n","keys","lang","on","has","winUtils","focus","_Plugin","ToggleButton","dijit","registry","ViewSource","stripScripts","stripComments","stripIFrames","readOnly","_fsPlugin","toggle","this","_vsFocused","button","set","get","_initButton","strings","getLocalization","editor","label","ownerDocument","dir","showLabel","iconClass","iconClassPrefix","tabIndex","onChange","hitch","_ieFixNode","create","style","opacity","zIndex","position","top","ownerDocumentBody","setEditor","addKeyHandler","F12","e","stopPropagation","preventDefault","setTimeout","focused","_showSource","source","html","ed","edPlugins","_plugins","_sourceShown","self","sourceArea","_createSourceView","_sourceQueryCommandEnabled","queryCommandEnabled","cmd","toLowerCase","onDisplayChanged","_filter","forEach","p","isInstanceOf","_getAltViewNode","value","height","iframe","width","display","_resizeHandle","window","vp","getBox","w","_prevW","h","_prevH","_resizer","clearTimeout","_resize","onNormalizedDisplayChanged","__oldGetValue","getValue","txt","_setListener","after","htmlTxt","remove","_readOnly","beginEditing","endEditing","parent","domNode","parentNode","container","getEnclosingWidget","resize","console","log","updateState","tbH","getHeaderHeight","fH","getFooterHeight","eb","containerPadding","getPadBorderExtents","containerMargin","getMarginExtents","extents","edb","isFullscreen","_ie7zoom","offsetTop","Math","floor","setMarginBox","padding","margin","borderWidth","borderStyle","id","place","lastChild","_viewsource_oldFocus","i","setSourceAreaCaret","editNode","length","declaredClass","_scopeName","_viewsource_getAltViewNode","own","keyCode","ctrlKey","shiftKey","_stripScripts","replace","_stripComments","_stripIFrames","elem","setSelectionRange","createTextRange","range","collapse","moveStart","moveEnd","select","destroy","inherited","arguments","args"],"mappings":"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","file":"../../../_editor/plugins/ViewSource.js","sourcesContent":["define([\r\n\t\"dojo/_base/array\", // array.forEach\r\n\t\"dojo/aspect\", // Aspect commands for advice\r\n\t\"dojo/_base/declare\", // declare\r\n\t\"dojo/dom-attr\", // domAttr.set\r\n\t\"dojo/dom-construct\", // domConstruct.create domConstruct.place\r\n\t\"dojo/dom-geometry\", // domGeometry.setMarginBox domGeometry.position\r\n\t\"dojo/dom-style\", // domStyle.set\r\n\t\"dojo/i18n\", // i18n.getLocalization\r\n\t\"dojo/keys\", // keys.F12\r\n\t\"dojo/_base/lang\", // lang.hitch\r\n\t\"dojo/on\", // on()\r\n\t\"dojo/sniff\", // has(\"ie\")\r\n\t\"dojo/window\", // winUtils.getBox\r\n\t\"../../focus\", // focus.focus()\r\n\t\"../_Plugin\",\r\n\t\"../../form/ToggleButton\",\r\n\t\"../..\", // dijit._scopeName\r\n\t\"../../registry\", // registry.getEnclosingWidget()\r\n\t\"dojo/i18n!../nls/commands\"\r\n], function(array, aspect, declare, domAttr, domConstruct, domGeometry, domStyle, i18n, keys, lang, on, has, winUtils,\r\n\t\t\tfocus, _Plugin, ToggleButton, dijit, registry){\r\n\r\n\t// module:\r\n\t//\t\tdijit/_editor/plugins/ViewSource\r\n\r\n\tvar ViewSource = declare(\"dijit._editor.plugins.ViewSource\", _Plugin, {\r\n\t\t// summary:\r\n\t\t//\t\tThis plugin provides a simple view source capability.  When view\r\n\t\t//\t\tsource mode is enabled, it disables all other buttons/plugins on the RTE.\r\n\t\t//\t\tIt also binds to the hotkey: CTRL-SHIFT-F11 for toggling ViewSource mode.\r\n\r\n\t\t// stripScripts: [public] Boolean\r\n\t\t//\t\tBoolean flag used to indicate if script tags should be stripped from the document.\r\n\t\t//\t\tDefaults to true.\r\n\t\tstripScripts: true,\r\n\r\n\t\t// stripComments: [public] Boolean\r\n\t\t//\t\tBoolean flag used to indicate if comment tags should be stripped from the document.\r\n\t\t//\t\tDefaults to true.\r\n\t\tstripComments: true,\r\n\r\n\t\t// stripComments: [public] Boolean\r\n\t\t//\t\tBoolean flag used to indicate if iframe tags should be stripped from the document.\r\n\t\t//\t\tDefaults to true.\r\n\t\tstripIFrames: true,\r\n\r\n\t\t// readOnly: [const] Boolean\r\n\t\t//\t\tBoolean flag used to indicate if the source view should be readonly or not.\r\n\t\t//\t\tCannot be changed after initialization of the plugin.\r\n\t\t//\t\tDefaults to false.\r\n\t\treadOnly: false,\r\n\r\n\t\t// _fsPlugin: [private] Object\r\n\t\t//\t\tReference to a registered fullscreen plugin so that viewSource knows\r\n\t\t//\t\thow to scale.\r\n\t\t_fsPlugin: null,\r\n\r\n\t\ttoggle: function(){\r\n\t\t\t// summary:\r\n\t\t\t//\t\tFunction to allow programmatic toggling of the view.\r\n\r\n\t\t\t// For Webkit, we have to focus a very particular way.\r\n\t\t\t// when swapping views, otherwise focus doesn't shift right\r\n\t\t\t// but can't focus this way all the time, only for VS changes.\r\n\t\t\t// If we did it all the time, buttons like bold, italic, etc\r\n\t\t\t// break.\r\n\t\t\tif(has(\"webkit\")){\r\n\t\t\t\tthis._vsFocused = true;\r\n\t\t\t}\r\n\t\t\tthis.button.set(\"checked\", !this.button.get(\"checked\"));\r\n\r\n\t\t},\r\n\r\n\t\t_initButton: function(){\r\n\t\t\t// summary:\r\n\t\t\t//\t\tOver-ride for creation of the resize button.\r\n\t\t\tvar strings = i18n.getLocalization(\"dijit._editor\", \"commands\"),\r\n\t\t\t\teditor = this.editor;\r\n\t\t\tthis.button = new ToggleButton({\r\n\t\t\t\tlabel: strings[\"viewSource\"],\r\n\t\t\t\townerDocument: editor.ownerDocument,\r\n\t\t\t\tdir: editor.dir,\r\n\t\t\t\tlang: editor.lang,\r\n\t\t\t\tshowLabel: false,\r\n\t\t\t\ticonClass: this.iconClassPrefix + \" \" + this.iconClassPrefix + \"ViewSource\",\r\n\t\t\t\ttabIndex: \"-1\",\r\n\t\t\t\tonChange: lang.hitch(this, \"_showSource\")\r\n\t\t\t});\r\n\r\n\t\t\t// IE 7 has a horrible bug with zoom, so we have to create this node\r\n\t\t\t// to cross-check later.  Sigh.\r\n\t\t\tif(has(\"ie\") == 7){\r\n\t\t\t\tthis._ieFixNode = domConstruct.create(\"div\", {\r\n\t\t\t\t\tstyle: {\r\n\t\t\t\t\t\topacity: \"0\",\r\n\t\t\t\t\t\tzIndex: \"-1000\",\r\n\t\t\t\t\t\tposition: \"absolute\",\r\n\t\t\t\t\t\ttop: \"-1000px\"\r\n\t\t\t\t\t}\r\n\t\t\t\t}, editor.ownerDocumentBody);\r\n\t\t\t}\r\n\t\t\t// Make sure readonly mode doesn't make the wrong cursor appear over the button.\r\n\t\t\tthis.button.set(\"readOnly\", false);\r\n\t\t},\r\n\r\n\r\n\t\tsetEditor: function(/*dijit/Editor*/ editor){\r\n\t\t\t// summary:\r\n\t\t\t//\t\tTell the plugin which Editor it is associated with.\r\n\t\t\t// editor: Object\r\n\t\t\t//\t\tThe editor object to attach the print capability to.\r\n\t\t\tthis.editor = editor;\r\n\t\t\tthis._initButton();\r\n\r\n\t\t\tthis.editor.addKeyHandler(keys.F12, true, true, lang.hitch(this, function(e){\r\n\t\t\t\t// Move the focus before switching\r\n\t\t\t\t// It'll focus back.  Hiding a focused\r\n\t\t\t\t// node causes issues.\r\n\t\t\t\tthis.button.focus();\r\n\t\t\t\tthis.toggle();\r\n\t\t\t\te.stopPropagation();\r\n\t\t\t\te.preventDefault();\r\n\r\n\t\t\t\t// Call the focus shift outside of the handler.\r\n\t\t\t\tsetTimeout(lang.hitch(this, function(){\r\n\t\t\t\t\t// Focus the textarea... unless focus has moved outside of the editor completely during the timeout.\r\n\t\t\t\t\t// Since we override focus, so we just need to call it.\r\n\t\t\t\t\tif(this.editor.focused){\r\n\t\t\t\t\t\tthis.editor.focus();\r\n\t\t\t\t\t}\r\n\t\t\t\t}), 100);\r\n\t\t\t}));\r\n\t\t},\r\n\r\n\t\t_showSource: function(source){\r\n\t\t\t// summary:\r\n\t\t\t//\t\tFunction to toggle between the source and RTE views.\r\n\t\t\t// source: boolean\r\n\t\t\t//\t\tBoolean value indicating if it should be in source mode or not.\r\n\t\t\t// tags:\r\n\t\t\t//\t\tprivate\r\n\t\t\tvar ed = this.editor;\r\n\t\t\tvar edPlugins = ed._plugins;\r\n\t\t\tvar html;\r\n\t\t\tthis._sourceShown = source;\r\n\t\t\tvar self = this;\r\n\t\t\ttry{\r\n\t\t\t\tif(!this.sourceArea){\r\n\t\t\t\t\tthis._createSourceView();\r\n\t\t\t\t}\r\n\t\t\t\tif(source){\r\n\t\t\t\t\t// Update the QueryCommandEnabled function to disable everything but\r\n\t\t\t\t\t// the source view mode.  Have to over-ride a function, then kick all\r\n\t\t\t\t\t// plugins to check their state.\r\n\t\t\t\t\ted._sourceQueryCommandEnabled = ed.queryCommandEnabled;\r\n\t\t\t\t\ted.queryCommandEnabled = function(cmd){\r\n\t\t\t\t\t\treturn cmd.toLowerCase() === \"viewsource\";\r\n\t\t\t\t\t};\r\n\t\t\t\t\tthis.editor.onDisplayChanged();\r\n\t\t\t\t\thtml = ed.get(\"value\");\r\n\t\t\t\t\thtml = this._filter(html);\r\n\t\t\t\t\ted.set(\"value\", html);\r\n\t\t\t\t\tarray.forEach(edPlugins, function(p){\r\n\t\t\t\t\t\t// Turn off any plugins not controlled by queryCommandenabled.\r\n\t\t\t\t\t\tif(p && !(p instanceof ViewSource) && p.isInstanceOf(_Plugin)){\r\n\t\t\t\t\t\t\tp.set(\"disabled\", true)\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t});\r\n\r\n\t\t\t\t\t// We actually do need to trap this plugin and adjust how we\r\n\t\t\t\t\t// display the textarea.\r\n\t\t\t\t\tif(this._fsPlugin){\r\n\t\t\t\t\t\tthis._fsPlugin._getAltViewNode = function(){\r\n\t\t\t\t\t\t\treturn self.sourceArea;\r\n\t\t\t\t\t\t};\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tthis.sourceArea.value = html;\r\n\r\n\t\t\t\t\t// Since neither iframe nor textarea have margin, border, or padding,\r\n\t\t\t\t\t// just set sizes equal\r\n\t\t\t\t\tthis.sourceArea.style.height = ed.iframe.style.height;\r\n\t\t\t\t\tthis.sourceArea.style.width = ed.iframe.style.width;\r\n\t\t\t\t\tdomStyle.set(ed.iframe, \"display\", \"none\");\r\n\t\t\t\t\tdomStyle.set(this.sourceArea, {\r\n\t\t\t\t\t\tdisplay: \"block\"\r\n\t\t\t\t\t});\r\n\r\n\t\t\t\t\tvar resizer = function(){\r\n\t\t\t\t\t\t// function to handle resize events.\r\n\t\t\t\t\t\t// Will check current VP and only resize if\r\n\t\t\t\t\t\t// different.\r\n\t\t\t\t\t\tvar vp = winUtils.getBox(ed.ownerDocument);\r\n\r\n\t\t\t\t\t\tif(\"_prevW\" in this && \"_prevH\" in this){\r\n\t\t\t\t\t\t\t// No actual size change, ignore.\r\n\t\t\t\t\t\t\tif(vp.w === this._prevW && vp.h === this._prevH){\r\n\t\t\t\t\t\t\t\treturn;\r\n\t\t\t\t\t\t\t}else{\r\n\t\t\t\t\t\t\t\tthis._prevW = vp.w;\r\n\t\t\t\t\t\t\t\tthis._prevH = vp.h;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}else{\r\n\t\t\t\t\t\t\tthis._prevW = vp.w;\r\n\t\t\t\t\t\t\tthis._prevH = vp.h;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif(this._resizer){\r\n\t\t\t\t\t\t\tclearTimeout(this._resizer);\r\n\t\t\t\t\t\t\tdelete this._resizer;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\t// Timeout it to help avoid spamming resize on IE.\r\n\t\t\t\t\t\t// Works for all browsers.\r\n\t\t\t\t\t\tthis._resizer = setTimeout(lang.hitch(this, function(){\r\n\t\t\t\t\t\t\tdelete this._resizer;\r\n\t\t\t\t\t\t\tthis._resize();\r\n\t\t\t\t\t\t}), 10);\r\n\t\t\t\t\t};\r\n\t\t\t\t\tthis._resizeHandle = on(window, \"resize\", lang.hitch(this, resizer));\r\n\r\n\t\t\t\t\t//Call this on a delay once to deal with IE glitchiness on initial size.\r\n\t\t\t\t\tsetTimeout(lang.hitch(this, this._resize), 100);\r\n\r\n\t\t\t\t\t//Trigger a check for command enablement/disablement.\r\n\t\t\t\t\tthis.editor.onNormalizedDisplayChanged();\r\n\r\n\t\t\t\t\tthis.editor.__oldGetValue = this.editor.getValue;\r\n\t\t\t\t\tthis.editor.getValue = lang.hitch(this, function(){\r\n\t\t\t\t\t\tvar txt = this.sourceArea.value;\r\n\t\t\t\t\t\ttxt = this._filter(txt);\r\n\t\t\t\t\t\treturn txt;\r\n\t\t\t\t\t});\r\n\r\n\t\t\t\t\tthis._setListener = aspect.after(this.editor, \"setValue\", lang.hitch(this, function(htmlTxt){\r\n\t\t\t\t\t\thtmlTxt = htmlTxt || \"\";\r\n\t\t\t\t\t\thtmlTxt = this._filter(htmlTxt);\r\n\t\t\t\t\t\tthis.sourceArea.value = htmlTxt;\r\n\t\t\t\t\t}), true);\r\n\t\t\t\t}else{\r\n\t\t\t\t\t// First check that we were in source view before doing anything.\r\n\t\t\t\t\t// corner case for being called with a value of false and we hadn't\r\n\t\t\t\t\t// actually been in source display mode.\r\n\t\t\t\t\tif(!ed._sourceQueryCommandEnabled){\r\n\t\t\t\t\t\treturn;\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\t// Remove the set listener.\r\n\t\t\t\t\tthis._setListener.remove();\r\n\t\t\t\t\tdelete this._setListener;\r\n\r\n\t\t\t\t\tthis._resizeHandle.remove();\r\n\t\t\t\t\tdelete this._resizeHandle;\r\n\r\n\t\t\t\t\tif(this.editor.__oldGetValue){\r\n\t\t\t\t\t\tthis.editor.getValue = this.editor.__oldGetValue;\r\n\t\t\t\t\t\tdelete this.editor.__oldGetValue;\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\t// Restore all the plugin buttons state.\r\n\t\t\t\t\ted.queryCommandEnabled = ed._sourceQueryCommandEnabled;\r\n\t\t\t\t\tif(!this._readOnly){\r\n\t\t\t\t\t\thtml = this.sourceArea.value;\r\n\t\t\t\t\t\thtml = this._filter(html);\r\n\t\t\t\t\t\ted.beginEditing();\r\n\t\t\t\t\t\ted.set(\"value\", html);\r\n\t\t\t\t\t\ted.endEditing();\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tarray.forEach(edPlugins, function(p){\r\n\t\t\t\t\t\t// Turn back on any plugins we turned off.\r\n\t\t\t\t\t\tif(p && p.isInstanceOf(_Plugin)){\r\n\t\t\t\t\t\t\tp.set(\"disabled\", false);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t});\r\n\r\n\t\t\t\t\tdomStyle.set(this.sourceArea, \"display\", \"none\");\r\n\t\t\t\t\tdomStyle.set(ed.iframe, \"display\", \"block\");\r\n\t\t\t\t\tdelete ed._sourceQueryCommandEnabled;\r\n\r\n\t\t\t\t\t//Trigger a check for command enablement/disablement.\r\n\t\t\t\t\tthis.editor.onDisplayChanged();\r\n\t\t\t\t}\r\n\t\t\t\t// Call a delayed resize to wait for some things to display in header/footer.\r\n\t\t\t\tsetTimeout(lang.hitch(this, function(){\r\n\t\t\t\t\t// Make resize calls.\r\n\t\t\t\t\tvar parent = ed.domNode.parentNode;\r\n\t\t\t\t\tif(parent){\r\n\t\t\t\t\t\tvar container = registry.getEnclosingWidget(parent);\r\n\t\t\t\t\t\tif(container && container.resize){\r\n\t\t\t\t\t\t\tcontainer.resize();\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\ted.resize();\r\n\t\t\t\t}), 300);\r\n\t\t\t}catch(e){\r\n\t\t\t\tconsole.log(e);\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\tupdateState: function(){\r\n\t\t\t// summary:\r\n\t\t\t//\t\tOver-ride for button state control for disabled to work.\r\n\t\t\tthis.button.set(\"disabled\", this.get(\"disabled\"));\r\n\t\t},\r\n\r\n\t\t_resize: function(){\r\n\t\t\t// summary:\r\n\t\t\t//\t\tInternal function to resize the source view\r\n\t\t\t// tags:\r\n\t\t\t//\t\tprivate\r\n\t\t\tvar ed = this.editor;\r\n\t\t\tvar tbH = ed.getHeaderHeight();\r\n\t\t\tvar fH = ed.getFooterHeight();\r\n\t\t\tvar eb = domGeometry.position(ed.domNode);\r\n\r\n\t\t\t// Styles are now applied to the internal source container, so we have\r\n\t\t\t// to subtract them off.\r\n\t\t\tvar containerPadding = domGeometry.getPadBorderExtents(ed.iframe.parentNode);\r\n\t\t\tvar containerMargin = domGeometry.getMarginExtents(ed.iframe.parentNode);\r\n\r\n\t\t\tvar extents = domGeometry.getPadBorderExtents(ed.domNode);\r\n\t\t\tvar edb = {\r\n\t\t\t\tw: eb.w - extents.w,\r\n\t\t\t\th: eb.h - (tbH + extents.h + fH)\r\n\t\t\t};\r\n\r\n\t\t\t// Fullscreen gets odd, so we need to check for the FS plugin and\r\n\t\t\t// adapt.\r\n\t\t\tif(this._fsPlugin && this._fsPlugin.isFullscreen){\r\n\t\t\t\t//Okay, probably in FS, adjust.\r\n\t\t\t\tvar vp = winUtils.getBox(ed.ownerDocument);\r\n\t\t\t\tedb.w = (vp.w - extents.w);\r\n\t\t\t\tedb.h = (vp.h - (tbH + extents.h + fH));\r\n\t\t\t}\r\n\r\n\t\t\tif(has(\"ie\")){\r\n\t\t\t\t// IE is always off by 2px, so we have to adjust here\r\n\t\t\t\t// Note that IE ZOOM is broken here.  I can't get\r\n\t\t\t\t//it to scale right.\r\n\t\t\t\tedb.h -= 2;\r\n\t\t\t}\r\n\r\n\t\t\t// IE has a horrible zoom bug.  So, we have to try and account for\r\n\t\t\t// it and fix up the scaling.\r\n\t\t\tif(this._ieFixNode){\r\n\t\t\t\tvar _ie7zoom = -this._ieFixNode.offsetTop / 1000;\r\n\t\t\t\tedb.w = Math.floor((edb.w + 0.9) / _ie7zoom);\r\n\t\t\t\tedb.h = Math.floor((edb.h + 0.9) / _ie7zoom);\r\n\t\t\t}\r\n\r\n\t\t\tdomGeometry.setMarginBox(this.sourceArea, {\r\n\t\t\t\tw: edb.w - (containerPadding.w + containerMargin.w),\r\n\t\t\t\th: edb.h - (containerPadding.h + containerMargin.h)\r\n\t\t\t});\r\n\r\n\t\t\t// Scale the parent container too in this case.\r\n\t\t\tdomGeometry.setMarginBox(ed.iframe.parentNode, {\r\n\t\t\t\th: edb.h\r\n\t\t\t});\r\n\t\t},\r\n\r\n\t\t_createSourceView: function(){\r\n\t\t\t// summary:\r\n\t\t\t//\t\tInternal function for creating the source view area.\r\n\t\t\t// tags:\r\n\t\t\t//\t\tprivate\r\n\t\t\tvar ed = this.editor;\r\n\t\t\tvar edPlugins = ed._plugins;\r\n\t\t\tthis.sourceArea = domConstruct.create(\"textarea\");\r\n\t\t\tif(this.readOnly){\r\n\t\t\t\tdomAttr.set(this.sourceArea, \"readOnly\", true);\r\n\t\t\t\tthis._readOnly = true;\r\n\t\t\t}\r\n\t\t\tdomStyle.set(this.sourceArea, {\r\n\t\t\t\tpadding: \"0px\",\r\n\t\t\t\tmargin: \"0px\",\r\n\t\t\t\tborderWidth: \"0px\",\r\n\t\t\t\tborderStyle: \"none\"\r\n\t\t\t});\r\n\t\t\tdomAttr.set(this.sourceArea, \"aria-label\", this.editor.id);\r\n\r\n\t\t\tdomConstruct.place(this.sourceArea, ed.iframe, \"before\");\r\n\r\n\t\t\tif(has(\"ie\") && ed.iframe.parentNode.lastChild !== ed.iframe){\r\n\t\t\t\t// There's some weirdo div in IE used for focus control\r\n\t\t\t\t// But is messed up scaling the textarea if we don't config\r\n\t\t\t\t// it some so it doesn't have a varying height.\r\n\t\t\t\tdomStyle.set(ed.iframe.parentNode.lastChild, {\r\n\t\t\t\t\twidth: \"0px\",\r\n\t\t\t\t\theight: \"0px\",\r\n\t\t\t\t\tpadding: \"0px\",\r\n\t\t\t\t\tmargin: \"0px\",\r\n\t\t\t\t\tborderWidth: \"0px\",\r\n\t\t\t\t\tborderStyle: \"none\"\r\n\t\t\t\t});\r\n\t\t\t}\r\n\r\n\t\t\t// We also need to take over editor focus a bit here, so that focus calls to\r\n\t\t\t// focus the editor will focus to the right node when VS is active.\r\n\t\t\ted._viewsource_oldFocus = ed.focus;\r\n\t\t\tvar self = this;\r\n\t\t\ted.focus = function(){\r\n\t\t\t\tif(self._sourceShown){\r\n\t\t\t\t\tself.setSourceAreaCaret();\r\n\t\t\t\t}else{\r\n\t\t\t\t\ttry{\r\n\t\t\t\t\t\tif(this._vsFocused){\r\n\t\t\t\t\t\t\tdelete this._vsFocused;\r\n\t\t\t\t\t\t\t// Must focus edit node in this case (webkit only) or\r\n\t\t\t\t\t\t\t// focus doesn't shift right, but in normal\r\n\t\t\t\t\t\t\t// cases we focus with the regular function.\r\n\t\t\t\t\t\t\tfocus.focus(ed.editNode);\r\n\t\t\t\t\t\t}else{\r\n\t\t\t\t\t\t\ted._viewsource_oldFocus();\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}catch(e){\r\n\t\t\t\t\t\tconsole.log(e);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t};\r\n\r\n\t\t\tvar i, p;\r\n\t\t\tfor(i = 0; i < edPlugins.length; i++){\r\n\t\t\t\t// We actually do need to trap this plugin and adjust how we\r\n\t\t\t\t// display the textarea.\r\n\t\t\t\tp = edPlugins[i];\r\n\t\t\t\tif(p && (p.declaredClass === \"dijit._editor.plugins.FullScreen\" ||\r\n\t\t\t\t\tp.declaredClass === (dijit._scopeName +\r\n\t\t\t\t\t\t\"._editor.plugins.FullScreen\"))){\r\n\t\t\t\t\tthis._fsPlugin = p;\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tif(this._fsPlugin){\r\n\t\t\t\t// Found, we need to over-ride the alt-view node function\r\n\t\t\t\t// on FullScreen with our own, chain up to parent call when appropriate.\r\n\t\t\t\tthis._fsPlugin._viewsource_getAltViewNode = this._fsPlugin._getAltViewNode;\r\n\t\t\t\tthis._fsPlugin._getAltViewNode = function(){\r\n\t\t\t\t\treturn self._sourceShown ? self.sourceArea : this._viewsource_getAltViewNode();\r\n\t\t\t\t};\r\n\t\t\t}\r\n\r\n\t\t\t// Listen to the source area for key events as well, as we need to be able to hotkey toggle\r\n\t\t\t// it from there too.\r\n\t\t\tthis.own(on(this.sourceArea, \"keydown\", lang.hitch(this, function(e){\r\n\t\t\t\tif(this._sourceShown && e.keyCode == keys.F12 && e.ctrlKey && e.shiftKey){\r\n\t\t\t\t\tthis.button.focus();\r\n\t\t\t\t\tthis.button.set(\"checked\", false);\r\n\t\t\t\t\tsetTimeout(lang.hitch(this, function(){\r\n\t\t\t\t\t\ted.focus();\r\n\t\t\t\t\t}), 100);\r\n\t\t\t\t\te.stopPropagation();\r\n\t\t\t\t\te.preventDefault();\r\n\t\t\t\t}\r\n\t\t\t})));\r\n\t\t},\r\n\r\n\t\t_stripScripts: function(html){\r\n\t\t\t// summary:\r\n\t\t\t//\t\tStrips out script tags from the HTML used in editor.\r\n\t\t\t// html: String\r\n\t\t\t//\t\tThe HTML to filter\r\n\t\t\t// tags:\r\n\t\t\t//\t\tprivate\r\n\t\t\tif(html){\r\n\t\t\t\t// Look for closed and unclosed (malformed) script attacks.\r\n\t\t\t\thtml = html.replace(/<\\s*script[^>]*>((.|\\s)*?)<\\\\?\\/\\s*script\\s*>/ig, \"\");\r\n\t\t\t\thtml = html.replace(/<\\s*script\\b([^<>]|\\s)*>?/ig, \"\");\r\n\t\t\t\thtml = html.replace(/<[^>]*=(\\s|)*[(\"|')]javascript:[^$1][(\\s|.)]*[$1][^>]*>/ig, \"\");\r\n\t\t\t}\r\n\t\t\treturn html;\r\n\t\t},\r\n\r\n\t\t_stripComments: function(html){\r\n\t\t\t// summary:\r\n\t\t\t//\t\tStrips out comments from the HTML used in editor.\r\n\t\t\t// html: String\r\n\t\t\t//\t\tThe HTML to filter\r\n\t\t\t// tags:\r\n\t\t\t//\t\tprivate\r\n\t\t\tif(html){\r\n\t\t\t\thtml = html.replace(/<!--(.|\\s){1,}?-->/g, \"\");\r\n\t\t\t}\r\n\t\t\treturn html;\r\n\t\t},\r\n\r\n\t\t_stripIFrames: function(html){\r\n\t\t\t// summary:\r\n\t\t\t//\t\tStrips out iframe tags from the content, to avoid iframe script\r\n\t\t\t//\t\tstyle injection attacks.\r\n\t\t\t// html: String\r\n\t\t\t//\t\tThe HTML to filter\r\n\t\t\t// tags:\r\n\t\t\t//\t\tprivate\r\n\t\t\tif(html){\r\n\t\t\t\thtml = html.replace(/<\\s*iframe[^>]*>((.|\\s)*?)<\\\\?\\/\\s*iframe\\s*>/ig, \"\");\r\n\t\t\t}\r\n\t\t\treturn html;\r\n\t\t},\r\n\r\n\t\t_filter: function(html){\r\n\t\t\t// summary:\r\n\t\t\t//\t\tInternal function to perform some filtering on the HTML.\r\n\t\t\t// html: String\r\n\t\t\t//\t\tThe HTML to filter\r\n\t\t\t// tags:\r\n\t\t\t//\t\tprivate\r\n\t\t\tif(html){\r\n\t\t\t\tif(this.stripScripts){\r\n\t\t\t\t\thtml = this._stripScripts(html);\r\n\t\t\t\t}\r\n\t\t\t\tif(this.stripComments){\r\n\t\t\t\t\thtml = this._stripComments(html);\r\n\t\t\t\t}\r\n\t\t\t\tif(this.stripIFrames){\r\n\t\t\t\t\thtml = this._stripIFrames(html);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\treturn html;\r\n\t\t},\r\n\r\n\t\tsetSourceAreaCaret: function(){\r\n\t\t\t// summary:\r\n\t\t\t//\t\tInternal function to set the caret in the sourceArea\r\n\t\t\t//\t\tto 0x0\r\n\t\t\tvar elem = this.sourceArea;\r\n\t\t\tfocus.focus(elem);\r\n\t\t\tif(this._sourceShown && !this.readOnly){\r\n\t\t\t\tif(elem.setSelectionRange){\r\n\t\t\t\t\telem.setSelectionRange(0, 0);\r\n\t\t\t\t}else if(this.sourceArea.createTextRange){\r\n\t\t\t\t\t// IE\r\n\t\t\t\t\tvar range = elem.createTextRange();\r\n\t\t\t\t\trange.collapse(true);\r\n\t\t\t\t\trange.moveStart(\"character\", -99999); // move to 0\r\n\t\t\t\t\trange.moveStart(\"character\", 0); // delta from 0 is the correct position\r\n\t\t\t\t\trange.moveEnd(\"character\", 0);\r\n\t\t\t\t\trange.select();\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\tdestroy: function(){\r\n\t\t\t// summary:\r\n\t\t\t//\t\tOver-ride to remove the node used to correct for IE's\r\n\t\t\t//\t\tzoom bug.\r\n\t\t\tif(this._ieFixNode){\r\n\t\t\t\tdomConstruct.destroy(this._ieFixNode);\r\n\t\t\t}\r\n\t\t\tif(this._resizer){\r\n\t\t\t\tclearTimeout(this._resizer);\r\n\t\t\t\tdelete this._resizer;\r\n\t\t\t}\r\n\t\t\tif(this._resizeHandle){\r\n\t\t\t\tthis._resizeHandle.remove();\r\n\t\t\t\tdelete this._resizeHandle;\r\n\t\t\t}\r\n\t\t\tif(this._setListener){\r\n\t\t\t\tthis._setListener.remove();\r\n\t\t\t\tdelete this._setListener;\r\n\t\t\t}\r\n\t\t\tthis.inherited(arguments);\r\n\t\t}\r\n\t});\r\n\r\n\t// Register this plugin.\r\n\t// For back-compat accept \"viewsource\" (all lowercase) too, remove in 2.0\r\n\t_Plugin.registry[\"viewSource\"] = _Plugin.registry[\"viewsource\"] = function(args){\r\n\t\treturn new ViewSource({\r\n\t\t\treadOnly: (\"readOnly\" in args) ? args.readOnly : false,\r\n\t\t\tstripComments: (\"stripComments\" in args) ? args.stripComments : true,\r\n\t\t\tstripScripts: (\"stripScripts\" in args) ? args.stripScripts : true,\r\n\t\t\tstripIFrames: (\"stripIFrames\" in args) ? args.stripIFrames : true\r\n\t\t});\r\n\t};\r\n\r\n\treturn ViewSource;\r\n});\r\n"]}