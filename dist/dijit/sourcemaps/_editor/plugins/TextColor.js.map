{"version":3,"sources":["_editor/plugins/TextColor.js"],"names":["define","require","colors","declare","lang","_Plugin","DropDownButton","TextColor","buttonClass","colorPicker","useDefaultCommand","_initButton","this","command","name","inherited","arguments","self","button","loadDropDown","callback","onColorPaletteLoad","ColorPalette","dropDown","dir","editor","ownerDocument","value","onChange","color","execCommand","onExecute","get","updateState","_e","_c","isLoaded","length","disabled","set","queryCommandValue","e","indexOf","fromRgb","toHex","toString","slice","registry","args"],"mappings":";;;;;;;AAAAA,QACC,UACA,cACA,qBACA,kBACA,aACA,6BACE,SAASC,QAASC,EAAQC,EAASC,EAAMC,EAASC,GAKpD,IAAIC,EAAYJ,EAAQ,kCAAmCE,GAU1DG,YAAaF,EAIbG,YAAa,qBAIbC,mBAAmB,EAEnBC,YAAa,WACZC,KAAKC,QAAUD,KAAKE,KAEpBF,KAAKG,UAAUC,WAGf,IAAIC,EAAOL,KACXA,KAAKM,OAAOC,aAAe,SAASC,GACnC,SAASC,EAAmBC,GAC3BL,EAAKC,OAAOK,SAAW,IAAID,GAC1BE,IAAKP,EAAKQ,OAAOD,IACjBE,cAAeT,EAAKQ,OAAOC,cAC3BC,MAAOV,EAAKU,MACZC,SAAU,SAASC,GAClBZ,EAAKQ,OAAOK,YAAYb,EAAKJ,QAASgB,IAEvCE,UAAW,WACVd,EAAKQ,OAAOK,YAAYb,EAAKJ,QAASD,KAAKoB,IAAI,aAGjDZ,IAE6B,iBAApBH,EAAKR,YACdR,SAASgB,EAAKR,aAAcY,GAE5BA,EAAmBJ,EAAKR,eAK3BwB,YAAa,WAOZ,IAAIC,EAAKtB,KAAKa,OACVU,EAAKvB,KAAKC,QACd,GAAIqB,GAAOA,EAAGE,UAAaD,EAAGE,OAA9B,CAIA,GAAGzB,KAAKM,OAAO,CACd,IAMIS,EANAW,EAAW1B,KAAKoB,IAAI,YAExB,GADApB,KAAKM,OAAOqB,IAAI,WAAYD,GACzBA,EACF,OAID,IACCX,EAAQO,EAAGM,kBAAkBL,IAAO,GACpC,MAAMM,GAENd,EAAQ,IAIE,IAATA,IACFA,EAAQ,WAEG,eAATA,IACFA,EAAQ,WAGU,iBAATA,EAENA,EAAMe,QAAQ,QAAU,IAC1Bf,EAAQzB,EAAOyC,QAAQhB,GAAOiB,UAI/BjB,GADAA,GAAkB,IAARA,IAAqB,GAAe,MAARA,GAA8B,SAARA,KAAsB,IACpEkB,SAAS,IACvBlB,EAAQ,UAAUmB,MAAM,EAAG,EAAInB,EAAMU,QAAUV,GAIhDf,KAAKe,MAAQA,EAEb,IAAIJ,EAAWX,KAAKM,OAAOK,SACxBA,GAAYA,EAASS,KAAOL,IAAUJ,EAASS,IAAI,UACrDT,EAASgB,IAAI,QAASZ,GAAO,OAahC,OAPAtB,EAAQ0C,SAAoB,UAAI,SAASC,GACxC,OAAO,IAAIzC,EAAUyC,IAEtB3C,EAAQ0C,SAAsB,YAAI,SAASC,GAC1C,OAAO,IAAIzC,EAAUyC,IAGfzC","file":"../../../_editor/plugins/TextColor.js","sourcesContent":["define([\r\n\t\"require\",\r\n\t\"dojo/colors\", // colors.fromRgb\r\n\t\"dojo/_base/declare\", // declare\r\n\t\"dojo/_base/lang\",\r\n\t\"../_Plugin\",\r\n\t\"../../form/DropDownButton\"\r\n], function(require, colors, declare, lang, _Plugin, DropDownButton){\r\n\r\n\t// module:\r\n\t//\t\tdijit/_editor/plugins/TextColor\r\n\r\n\tvar TextColor = declare(\"dijit._editor.plugins.TextColor\", _Plugin, {\r\n\t\t// summary:\r\n\t\t//\t\tThis plugin provides dropdown color pickers for setting text color and background color\r\n\t\t// description:\r\n\t\t//\t\tThe commands provided by this plugin are:\r\n\t\t//\r\n\t\t//\t\t- foreColor - sets the text color\r\n\t\t//\t\t- hiliteColor - sets the background color\r\n\r\n\t\t// Override _Plugin.buttonClass to use DropDownButton (with ColorPalette) to control this plugin\r\n\t\tbuttonClass: DropDownButton,\r\n\t\t\t\t\r\n\t\t// colorPicker: String|Constructor\r\n\t\t//\t\tThe color picker dijit to use, defaults to dijit/ColorPalette\r\n\t\tcolorPicker: \"dijit/ColorPalette\",\r\n\r\n\t\t// useDefaultCommand: Boolean\r\n\t\t//\t\tFalse as we do not use the default editor command/click behavior.\r\n\t\tuseDefaultCommand: false,\r\n\r\n\t\t_initButton: function(){\r\n\t\t\tthis.command = this.name;\r\n\r\n\t\t\tthis.inherited(arguments);\r\n\r\n\t\t\t// Setup to lazy load ColorPalette first time the button is clicked\r\n\t\t\tvar self = this;\r\n\t\t\tthis.button.loadDropDown = function(callback){\r\n\t\t\t\tfunction onColorPaletteLoad(ColorPalette){\r\n\t\t\t\t\tself.button.dropDown = new ColorPalette({\r\n\t\t\t\t\t\tdir: self.editor.dir,\r\n\t\t\t\t\t\townerDocument: self.editor.ownerDocument,\r\n\t\t\t\t\t\tvalue: self.value,\r\n\t\t\t\t\t\tonChange: function(color){\r\n\t\t\t\t\t\t\tself.editor.execCommand(self.command, color);\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\tonExecute: function(){\r\n\t\t\t\t\t\t\tself.editor.execCommand(self.command, this.get(\"value\"));\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t});\r\n\t\t\t\t\tcallback();\r\n\t\t\t\t}\r\n\t\t\t\tif(typeof self.colorPicker == \"string\"){\r\n\t\t\t\t\trequire([self.colorPicker], onColorPaletteLoad);\r\n\t\t\t\t}else{\r\n\t\t\t\t\tonColorPaletteLoad(self.colorPicker);\r\n\t\t\t\t}\r\n\t\t\t};\r\n\t\t},\r\n\r\n\t\tupdateState: function(){\r\n\t\t\t// summary:\r\n\t\t\t//\t\tOverrides _Plugin.updateState().  This updates the ColorPalette\r\n\t\t\t//\t\tto show the color of the currently selected text.\r\n\t\t\t// tags:\r\n\t\t\t//\t\tprotected\r\n\r\n\t\t\tvar _e = this.editor;\r\n\t\t\tvar _c = this.command;\r\n\t\t\tif(!_e || !_e.isLoaded || !_c.length){\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\r\n\t\t\tif(this.button){\r\n\t\t\t\tvar disabled = this.get(\"disabled\");\r\n\t\t\t\tthis.button.set(\"disabled\", disabled);\r\n\t\t\t\tif(disabled){\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\r\n\t\t\t\tvar value;\r\n\t\t\t\ttry{\r\n\t\t\t\t\tvalue = _e.queryCommandValue(_c) || \"\";\r\n\t\t\t\t}catch(e){\r\n\t\t\t\t\t//Firefox may throw error above if the editor is just loaded, ignore it\r\n\t\t\t\t\tvalue = \"\";\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tif(value == \"\"){\r\n\t\t\t\tvalue = \"#000000\";\r\n\t\t\t}\r\n\t\t\tif(value == \"transparent\"){\r\n\t\t\t\tvalue = \"#ffffff\";\r\n\t\t\t}\r\n\r\n\t\t\tif(typeof value == \"string\"){\r\n\t\t\t\t//if RGB value, convert to hex value\r\n\t\t\t\tif(value.indexOf(\"rgb\") > -1){\r\n\t\t\t\t\tvalue = colors.fromRgb(value).toHex();\r\n\t\t\t\t}\r\n\t\t\t}else{    //it's an integer(IE returns an MS access #)\r\n\t\t\t\tvalue = ((value & 0x0000ff) << 16) | (value & 0x00ff00) | ((value & 0xff0000) >>> 16);\r\n\t\t\t\tvalue = value.toString(16);\r\n\t\t\t\tvalue = \"#000000\".slice(0, 7 - value.length) + value;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tthis.value = value;\r\n\r\n\t\t\tvar dropDown = this.button.dropDown;\r\n\t\t\tif(dropDown && dropDown.get && value !== dropDown.get('value')){\r\n\t\t\t\tdropDown.set('value', value, false);\r\n\t\t\t}\r\n\t\t}\r\n\t});\r\n\r\n\t// Register this plugin.\r\n\t_Plugin.registry[\"foreColor\"] = function(args){\r\n\t\treturn new TextColor(args);\r\n\t};\r\n\t_Plugin.registry[\"hiliteColor\"] = function(args){\r\n\t\treturn new TextColor(args);\r\n\t};\r\n\r\n\treturn TextColor;\r\n});\r\n"]}