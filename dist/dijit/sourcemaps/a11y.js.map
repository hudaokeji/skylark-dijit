{"version":3,"sources":["a11y.js"],"names":["define","array","dom","domAttr","domStyle","lang","has","dijit","a11y","_isElementShown","elem","s","get","visibility","display","hasDefaultTabStop","nodeName","toLowerCase","body","contentDocument","designMode","e1","contentWindow","document","e2","contentEditable","firstChild","effectiveTabIndex","undefined","isTabNavigable","isFocusable","_getTabNavigable","root","first","last","lowest","lowestTabindex","highest","highestTabindex","radioSelected","radioName","node","tagName","type","name","shown","walkTree","parent","child","nextSibling","nodeType","scopeName","tabindex","rn","toUpperCase","rs","getFirstInTabbingOrder","doc","elems","byId","getLastInTabbingOrder","mixin"],"mappings":";;;;;;;AAAAA,QACC,mBACA,WACA,gBACA,iBACA,kBACA,aACA,YACE,SAASC,EAAOC,EAAKC,EAASC,EAAUC,EAAMC,EAAKC,GAKrD,IAEIC,GAIHC,gBAAiB,SAAqBC,GACrC,IAAIC,EAAIP,EAASQ,IAAIF,GACrB,MAAwB,UAAhBC,EAAEE,YACW,aAAhBF,EAAEE,YACW,QAAbF,EAAEG,SAC2B,UAA7BX,EAAQS,IAAIF,EAAM,SAGxBK,kBAAmB,SAAqBL,GAKvC,OAAOA,EAAKM,SAASC,eACpB,IAAK,IAEJ,OAAOd,EAAQG,IAAII,EAAM,QAC1B,IAAK,OACL,IAAK,SACL,IAAK,QACL,IAAK,SACL,IAAK,SACL,IAAK,WAEJ,OAAO,EACR,IAAK,SAEJ,IAAIQ,EACJ,IAEC,IAAIC,EAAkBT,EAAKS,gBAC3B,GAAG,eAAgBA,GAAiD,MAA9BA,EAAgBC,WACrD,OAAO,EAERF,EAAOC,EAAgBD,KACvB,MAAMG,GAIN,IACCH,EAAOR,EAAKY,cAAcC,SAASL,KACnC,MAAMM,GACN,OAAO,GAGT,OAAON,IAAiC,QAAxBA,EAAKO,iBACnBP,EAAKQ,YAAiD,QAAnCR,EAAKQ,WAAWD,iBACtC,QACC,MAA+B,QAAxBf,EAAKe,kBAIfE,kBAAmB,SAAqBjB,GAIvC,OAAGP,EAAQS,IAAIF,EAAM,iBACpB,EACQP,EAAQG,IAAII,EAAM,aAElBP,EAAQS,IAAIF,EAAM,YAGnBF,EAAKO,kBAAkBL,GAAQ,OArErCkB,GAyEHC,eAAgB,SAAqBnB,GAIpC,OAAOF,EAAKmB,kBAAkBjB,IAAS,GAGxCoB,YAAa,SAAqBpB,GAIjC,OAAOF,EAAKmB,kBAAkBjB,KAAU,GAGzCqB,iBAAkB,SAAqBC,GActC,IAAIC,EAAOC,EAAMC,EAAQC,EAAgBC,EAASC,EAAiBC,KAEnE,SAASC,EAAUC,GAElB,OAAOA,GAAsC,SAA9BA,EAAKC,QAAQzB,eAC3BwB,EAAKE,MAAmC,SAA3BF,EAAKE,KAAK1B,eACvBwB,EAAKG,MAAQH,EAAKG,KAAK3B,cAGzB,IAAI4B,EAAQrC,EAAKC,gBAAiBkB,EAAoBnB,EAAKmB,kBACvDmB,EAAW,SAAqBC,GACnC,IAAI,IAAIC,EAAQD,EAAOrB,WAAYsB,EAAOA,EAAQA,EAAMC,YAGvD,KAAqB,GAAlBD,EAAME,UAAkB5C,EAAI,OAAS,GAAyB,SAApB0C,EAAMG,YAA0BN,EAAMG,GAAnF,CAIA,IAAII,EAAWzB,EAAkBqB,GACjC,GAAGI,GAAY,EAAE,CACD,GAAZA,GACEnB,IACHA,EAAQe,GAETd,EAAOc,GACCI,EAAW,MACfjB,GAAUiB,EAAWhB,KACxBA,EAAiBgB,EACjBjB,EAASa,KAENX,GAAWe,GAAYd,KAC1BA,EAAkBc,EAClBf,EAAUW,IAGZ,IAAIK,EAAKb,EAAUQ,GAChB7C,EAAQS,IAAIoC,EAAO,YAAcK,IACnCd,EAAcc,GAAML,GAGa,UAAhCA,EAAMhC,SAASsC,eACjBR,EAASE,KAOZ,SAASO,EAAGd,GAEX,OAAOF,EAAcC,EAAUC,KAAUA,EAG1C,OARGI,EAAMb,IACRc,EAASd,IAODC,MAAOsB,EAAGtB,GAAQC,KAAMqB,EAAGrB,GAAOC,OAAQoB,EAAGpB,GAASE,QAASkB,EAAGlB,KAG5EmB,uBAAwB,SAA4BxB,EAAoByB,GAIvE,IAAIC,EAAQlD,EAAKuB,iBAAiB7B,EAAIyD,KAAK3B,EAAMyB,IACjD,OAAOC,EAAMvB,OAASuB,EAAMvB,OAASuB,EAAMzB,OAG5C2B,sBAAuB,SAA4B5B,EAAoByB,GAItE,IAAIC,EAAQlD,EAAKuB,iBAAiB7B,EAAIyD,KAAK3B,EAAMyB,IACjD,OAAOC,EAAMxB,KAAOwB,EAAMxB,KAAOwB,EAAMrB,UAMzC,OAFA/B,EAAI,gBAAkBD,EAAKwD,MAAMtD,EAAOC,GAEjCA","file":"../a11y.js","sourcesContent":["define([\r\n\t\"dojo/_base/array\", // array.forEach array.map\r\n\t\"dojo/dom\",\t\t\t// dom.byId\r\n\t\"dojo/dom-attr\", // domAttr.attr domAttr.has\r\n\t\"dojo/dom-style\", // domStyle.style\r\n\t\"dojo/_base/lang\", // lang.mixin()\r\n\t\"dojo/sniff\", // has(\"ie\") has(\"extend-dojo\")\r\n\t\"./_dijit\"\t// for exporting methods to dijit namespace\r\n], function(array, dom, domAttr, domStyle, lang, has, dijit){\r\n\r\n\t// module:\r\n\t//\t\tdijit/a11y\r\n\r\n\tvar undefined;\r\n\r\n\tvar a11y = {\r\n\t\t// summary:\r\n\t\t//\t\tAccessibility utility functions (keyboard, tab stops, etc.)\r\n\r\n\t\t_isElementShown: function(/*Element*/ elem){\r\n\t\t\tvar s = domStyle.get(elem);\r\n\t\t\treturn (s.visibility != \"hidden\")\r\n\t\t\t\t&& (s.visibility != \"collapsed\")\r\n\t\t\t\t&& (s.display != \"none\")\r\n\t\t\t\t&& (domAttr.get(elem, \"type\") != \"hidden\");\r\n\t\t},\r\n\r\n\t\thasDefaultTabStop: function(/*Element*/ elem){\r\n\t\t\t// summary:\r\n\t\t\t//\t\tTests if element is tab-navigable even without an explicit tabIndex setting\r\n\r\n\t\t\t// No explicit tabIndex setting, need to investigate node type\r\n\t\t\tswitch(elem.nodeName.toLowerCase()){\r\n\t\t\t\tcase \"a\":\r\n\t\t\t\t\t// An <a> w/out a tabindex is only navigable if it has an href\r\n\t\t\t\t\treturn domAttr.has(elem, \"href\");\r\n\t\t\t\tcase \"area\":\r\n\t\t\t\tcase \"button\":\r\n\t\t\t\tcase \"input\":\r\n\t\t\t\tcase \"object\":\r\n\t\t\t\tcase \"select\":\r\n\t\t\t\tcase \"textarea\":\r\n\t\t\t\t\t// These are navigable by default\r\n\t\t\t\t\treturn true;\r\n\t\t\t\tcase \"iframe\":\r\n\t\t\t\t\t// If it's an editor <iframe> then it's tab navigable.\r\n\t\t\t\t\tvar body;\r\n\t\t\t\t\ttry{\r\n\t\t\t\t\t\t// non-IE\r\n\t\t\t\t\t\tvar contentDocument = elem.contentDocument;\r\n\t\t\t\t\t\tif(\"designMode\" in contentDocument && contentDocument.designMode == \"on\"){\r\n\t\t\t\t\t\t\treturn true;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tbody = contentDocument.body;\r\n\t\t\t\t\t}catch(e1){\r\n\t\t\t\t\t\t// contentWindow.document isn't accessible within IE7/8\r\n\t\t\t\t\t\t// if the iframe.src points to a foreign url and this\r\n\t\t\t\t\t\t// page contains an element, that could get focus\r\n\t\t\t\t\t\ttry{\r\n\t\t\t\t\t\t\tbody = elem.contentWindow.document.body;\r\n\t\t\t\t\t\t}catch(e2){\r\n\t\t\t\t\t\t\treturn false;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\treturn body && (body.contentEditable == 'true' ||\r\n\t\t\t\t\t\t(body.firstChild && body.firstChild.contentEditable == 'true'));\r\n\t\t\t\tdefault:\r\n\t\t\t\t\treturn elem.contentEditable == 'true';\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\teffectiveTabIndex: function(/*Element*/ elem){\r\n\t\t\t// summary:\r\n\t\t\t//\t\tReturns effective tabIndex of an element, either a number, or undefined if element isn't focusable.\r\n\r\n\t\t\tif(domAttr.get(elem, \"disabled\")){\r\n\t\t\t\treturn undefined;\r\n\t\t\t}else if(domAttr.has(elem, \"tabIndex\")){\r\n\t\t\t\t// Explicit tab index setting\r\n\t\t\t\treturn +domAttr.get(elem, \"tabIndex\");// + to convert string --> number\r\n\t\t\t}else{\r\n\t\t\t\t// No explicit tabIndex setting, so depends on node type\r\n\t\t\t\treturn a11y.hasDefaultTabStop(elem) ? 0 : undefined;\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\tisTabNavigable: function(/*Element*/ elem){\r\n\t\t\t// summary:\r\n\t\t\t//\t\tTests if an element is tab-navigable\r\n\r\n\t\t\treturn a11y.effectiveTabIndex(elem) >= 0;\r\n\t\t},\r\n\r\n\t\tisFocusable: function(/*Element*/ elem){\r\n\t\t\t// summary:\r\n\t\t\t//\t\tTests if an element is focusable by tabbing to it, or clicking it with the mouse.\r\n\r\n\t\t\treturn a11y.effectiveTabIndex(elem) >= -1;\r\n\t\t},\r\n\r\n\t\t_getTabNavigable: function(/*DOMNode*/ root){\r\n\t\t\t// summary:\r\n\t\t\t//\t\tFinds descendants of the specified root node.\r\n\t\t\t// description:\r\n\t\t\t//\t\tFinds the following descendants of the specified root node:\r\n\t\t\t//\r\n\t\t\t//\t\t- the first tab-navigable element in document order\r\n\t\t\t//\t\t  without a tabIndex or with tabIndex=\"0\"\r\n\t\t\t//\t\t- the last tab-navigable element in document order\r\n\t\t\t//\t\t  without a tabIndex or with tabIndex=\"0\"\r\n\t\t\t//\t\t- the first element in document order with the lowest\r\n\t\t\t//\t\t  positive tabIndex value\r\n\t\t\t//\t\t- the last element in document order with the highest\r\n\t\t\t//\t\t  positive tabIndex value\r\n\t\t\tvar first, last, lowest, lowestTabindex, highest, highestTabindex, radioSelected = {};\r\n\r\n\t\t\tfunction radioName(node){\r\n\t\t\t\t// If this element is part of a radio button group, return the name for that group.\r\n\t\t\t\treturn node && node.tagName.toLowerCase() == \"input\" &&\r\n\t\t\t\t\tnode.type && node.type.toLowerCase() == \"radio\" &&\r\n\t\t\t\t\tnode.name && node.name.toLowerCase();\r\n\t\t\t}\r\n\r\n\t\t\tvar shown = a11y._isElementShown, effectiveTabIndex = a11y.effectiveTabIndex;\r\n\t\t\tvar walkTree = function(/*DOMNode*/ parent){\r\n\t\t\t\tfor(var child = parent.firstChild; child; child = child.nextSibling){\r\n\t\t\t\t\t// Skip text elements, hidden elements, and also non-HTML elements (those in custom namespaces) in IE,\r\n\t\t\t\t\t// since show() invokes getAttribute(\"type\"), which crash on VML nodes in IE.\r\n\t\t\t\t\tif(child.nodeType != 1 || (has(\"ie\") <= 9 && child.scopeName !== \"HTML\") || !shown(child)){\r\n\t\t\t\t\t\tcontinue;\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tvar tabindex = effectiveTabIndex(child);\r\n\t\t\t\t\tif(tabindex >= 0){\r\n\t\t\t\t\t\tif(tabindex == 0){\r\n\t\t\t\t\t\t\tif(!first){\r\n\t\t\t\t\t\t\t\tfirst = child;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tlast = child;\r\n\t\t\t\t\t\t}else if(tabindex > 0){\r\n\t\t\t\t\t\t\tif(!lowest || tabindex < lowestTabindex){\r\n\t\t\t\t\t\t\t\tlowestTabindex = tabindex;\r\n\t\t\t\t\t\t\t\tlowest = child;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tif(!highest || tabindex >= highestTabindex){\r\n\t\t\t\t\t\t\t\thighestTabindex = tabindex;\r\n\t\t\t\t\t\t\t\thighest = child;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tvar rn = radioName(child);\r\n\t\t\t\t\t\tif(domAttr.get(child, \"checked\") && rn){\r\n\t\t\t\t\t\t\tradioSelected[rn] = child;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif(child.nodeName.toUpperCase() != 'SELECT'){\r\n\t\t\t\t\t\twalkTree(child);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t};\r\n\t\t\tif(shown(root)){\r\n\t\t\t\twalkTree(root);\r\n\t\t\t}\r\n\t\t\tfunction rs(node){\r\n\t\t\t\t// substitute checked radio button for unchecked one, if there is a checked one with the same name.\r\n\t\t\t\treturn radioSelected[radioName(node)] || node;\r\n\t\t\t}\r\n\r\n\t\t\treturn { first: rs(first), last: rs(last), lowest: rs(lowest), highest: rs(highest) };\r\n\t\t},\r\n\r\n\t\tgetFirstInTabbingOrder: function(/*String|DOMNode*/ root, /*Document?*/ doc){\r\n\t\t\t// summary:\r\n\t\t\t//\t\tFinds the descendant of the specified root node\r\n\t\t\t//\t\tthat is first in the tabbing order\r\n\t\t\tvar elems = a11y._getTabNavigable(dom.byId(root, doc));\r\n\t\t\treturn elems.lowest ? elems.lowest : elems.first; // DomNode\r\n\t\t},\r\n\r\n\t\tgetLastInTabbingOrder: function(/*String|DOMNode*/ root, /*Document?*/ doc){\r\n\t\t\t// summary:\r\n\t\t\t//\t\tFinds the descendant of the specified root node\r\n\t\t\t//\t\tthat is last in the tabbing order\r\n\t\t\tvar elems = a11y._getTabNavigable(dom.byId(root, doc));\r\n\t\t\treturn elems.last ? elems.last : elems.highest; // DomNode\r\n\t\t}\r\n\t};\r\n\r\n\thas(\"extend-dojo\") && lang.mixin(dijit, a11y);\r\n\r\n\treturn a11y;\r\n});\r\n"]}