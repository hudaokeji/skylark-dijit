{"version":3,"sources":["form/TextBox.js"],"names":["define","declare","domConstruct","domStyle","kernel","lang","on","has","_FormValueWidget","_TextBoxMixin","template","dijit","TextBox","templateString","_singleNodeTemplate","_buttonInputDisabled","baseClass","postMixInProperties","type","this","toLowerCase","constructor","prototype","inherited","arguments","postCreate","defer","s","getComputedStyle","domNode","ff","fontFamily","inputs","getElementsByTagName","i","length","style","e","_setPlaceHolderAttr","v","_set","_phspan","_attachPoints","push","create","className","textbox","own","evt","preventDefault","hitch","focus","innerHTML","appendChild","ownerDocument","createTextNode","_updatePlaceHolder","_onInput","display","placeHolder","value","_setValueAttr","priorityChange","formattedValue","getDisplayedValue","deprecated","declaredClass","get","setDisplayedValue","set","_onBlur","disabled","selectOnClick","selectionStart","selectionEnd","undefined","_onFocus","by","readOnly","_isTextSelected","range","selection","createRange","parentElement","text","_setSelectionRange","element","start","stop","createTextRange","r","collapse","moveStart","moveEnd","select","applyTextDir"],"mappings":"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","file":"../../form/TextBox.js","sourcesContent":["define([\r\n\t\"dojo/_base/declare\", // declare\r\n\t\"dojo/dom-construct\", // domConstruct.create\r\n\t\"dojo/dom-style\", // domStyle.getComputedStyle\r\n\t\"dojo/_base/kernel\", // kernel.deprecated\r\n\t\"dojo/_base/lang\", // lang.hitch\r\n\t\"dojo/on\",\r\n\t\"dojo/sniff\", // has(\"ie\") has(\"mozilla\")\r\n\t\"./_FormValueWidget\",\r\n\t\"./_TextBoxMixin\",\r\n\t\"dojo/text!./templates/TextBox.html\",\r\n\t\"../main\"\t// to export dijit._setSelectionRange, remove in 2.0\r\n], function(declare, domConstruct, domStyle, kernel, lang, on, has,\r\n\t\t\t_FormValueWidget, _TextBoxMixin, template, dijit){\r\n\r\n\t// module:\r\n\t//\t\tdijit/form/TextBox\r\n\r\n\tvar TextBox = declare(\"dijit.form.TextBox\" + (has(\"dojo-bidi\") ? \"_NoBidi\" : \"\"), [_FormValueWidget, _TextBoxMixin], {\r\n\t\t// summary:\r\n\t\t//\t\tA base class for textbox form inputs\r\n\r\n\t\ttemplateString: template,\r\n\t\t_singleNodeTemplate: '<input class=\"dijit dijitReset dijitLeft dijitInputField\" data-dojo-attach-point=\"textbox,focusNode\" autocomplete=\"off\" type=\"${type}\" ${!nameAttrSetting} />',\r\n\r\n\t\t_buttonInputDisabled: has(\"ie\") ? \"disabled\" : \"\", // allows IE to disallow focus, but Firefox cannot be disabled for mousedown events\r\n\r\n\t\tbaseClass: \"dijitTextBox\",\r\n\r\n\t\tpostMixInProperties: function(){\r\n\t\t\tvar type = this.type.toLowerCase();\r\n\t\t\tif(this.templateString && this.templateString.toLowerCase() == \"input\" || ((type == \"hidden\" || type == \"file\") && this.templateString == this.constructor.prototype.templateString)){\r\n\t\t\t\tthis.templateString = this._singleNodeTemplate;\r\n\t\t\t}\r\n\t\t\tthis.inherited(arguments);\r\n\t\t},\r\n\r\n\t\tpostCreate: function(){\r\n\t\t\tthis.inherited(arguments);\r\n\r\n\t\t\tif(has(\"ie\") < 9){\r\n\t\t\t\t// IE INPUT tag fontFamily has to be set directly using STYLE\r\n\t\t\t\t// the defer gives IE a chance to render the TextBox and to deal with font inheritance\r\n\t\t\t\tthis.defer(function(){\r\n\t\t\t\t\ttry{\r\n\t\t\t\t\t\tvar s = domStyle.getComputedStyle(this.domNode); // can throw an exception if widget is immediately destroyed\r\n\t\t\t\t\t\tif(s){\r\n\t\t\t\t\t\t\tvar ff = s.fontFamily;\r\n\t\t\t\t\t\t\tif(ff){\r\n\t\t\t\t\t\t\t\tvar inputs = this.domNode.getElementsByTagName(\"INPUT\");\r\n\t\t\t\t\t\t\t\tif(inputs){\r\n\t\t\t\t\t\t\t\t\tfor(var i=0; i < inputs.length; i++){\r\n\t\t\t\t\t\t\t\t\t\tinputs[i].style.fontFamily = ff;\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}catch(e){/*when used in a Dialog, and this is called before the dialog is\r\n\t\t\t\t\t shown, s.fontFamily would trigger \"Invalid Argument\" error.*/}\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\t_setPlaceHolderAttr: function(v){\r\n\t\t\tthis._set(\"placeHolder\", v);\r\n\t\t\tif(!this._phspan){\r\n\t\t\t\tthis._attachPoints.push('_phspan');\r\n\t\t\t\tthis._phspan = domConstruct.create('span', {\r\n\t\t\t\t\t// dijitInputField class gives placeHolder same padding as the input field\r\n\t\t\t\t\t// parent node already has dijitInputField class but it doesn't affect this <span>\r\n\t\t\t\t\t// since it's position: absolute.\r\n\t\t\t\t\tclassName: 'dijitPlaceHolder dijitInputField'\r\n\t\t\t\t}, this.textbox, 'after');\r\n\t\t\t\tthis.own(\r\n\t\t\t\t\ton(this._phspan, \"mousedown\", function(evt){ evt.preventDefault(); }),\r\n\t\t\t\t\ton(this._phspan, \"touchend, pointerup, MSPointerUp\", lang.hitch(this, function(){\r\n\t\t\t\t\t\t// If the user clicks placeholder rather than the <input>, need programmatic focus.  Normally this\r\n\t\t\t\t\t\t// is done in _FormWidgetMixin._onFocus() but after [30663] it's done on a delay, which is ineffective.\r\n\t\t\t\t\t\tthis.focus();\r\n\t\t\t\t\t}))\r\n\t\t\t\t);\r\n\t\t\t}\r\n\t\t\tthis._phspan.innerHTML=\"\";\r\n\t\t\tthis._phspan.appendChild(this._phspan.ownerDocument.createTextNode(v));\r\n\t\t\tthis._updatePlaceHolder();\r\n\t\t},\r\n\r\n\t\t_onInput: function(/*Event*/ evt){\r\n\t\t\t// summary:\r\n\t\t\t//\t\tCalled AFTER the input event has happened\r\n\t\t\t//\t\tSee if the placeHolder text should be removed or added while editing.\r\n\t\t\tthis.inherited(arguments);\r\n\t\t\tthis._updatePlaceHolder();\r\n\t\t},\r\n\r\n\t\t_updatePlaceHolder: function(){\r\n\t\t\tif(this._phspan){\r\n\t\t\t\tthis._phspan.style.display = (this.placeHolder && !this.textbox.value) ? \"\" : \"none\";\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\t_setValueAttr: function(value, /*Boolean?*/ priorityChange, /*String?*/ formattedValue){\r\n\t\t\tthis.inherited(arguments);\r\n\t\t\tthis._updatePlaceHolder();\r\n\t\t},\r\n\r\n\t\tgetDisplayedValue: function(){\r\n\t\t\t// summary:\r\n\t\t\t//\t\tDeprecated.  Use get('displayedValue') instead.\r\n\t\t\t// tags:\r\n\t\t\t//\t\tdeprecated\r\n\t\t\tkernel.deprecated(this.declaredClass+\"::getDisplayedValue() is deprecated. Use get('displayedValue') instead.\", \"\", \"2.0\");\r\n\t\t\treturn this.get('displayedValue');\r\n\t\t},\r\n\r\n\t\tsetDisplayedValue: function(/*String*/ value){\r\n\t\t\t// summary:\r\n\t\t\t//\t\tDeprecated.  Use set('displayedValue', ...) instead.\r\n\t\t\t// tags:\r\n\t\t\t//\t\tdeprecated\r\n\t\t\tkernel.deprecated(this.declaredClass+\"::setDisplayedValue() is deprecated. Use set('displayedValue', ...) instead.\", \"\", \"2.0\");\r\n\t\t\tthis.set('displayedValue', value);\r\n\t\t},\r\n\r\n\t\t_onBlur: function(e){\r\n\t\t\tif(this.disabled){ return; }\r\n\t\t\tthis.inherited(arguments);\r\n\t\t\tthis._updatePlaceHolder();\r\n\r\n\t\t\tif(has(\"mozilla\")){\r\n\t\t\t\tif(this.selectOnClick){\r\n\t\t\t\t\t// clear selection so that the next mouse click doesn't reselect\r\n\t\t\t\t\tthis.textbox.selectionStart = this.textbox.selectionEnd = undefined;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\t_onFocus: function(/*String*/ by){\r\n\t\t\tif(this.disabled || this.readOnly){ return; }\r\n\t\t\tthis.inherited(arguments);\r\n\t\t\tthis._updatePlaceHolder();\r\n\t\t}\r\n\t});\r\n\r\n\tif(has(\"ie\") < 9){\r\n\t\tTextBox.prototype._isTextSelected = function(){\r\n\t\t\tvar range = this.ownerDocument.selection.createRange();\r\n\t\t\tvar parent = range.parentElement();\r\n\t\t\treturn parent == this.textbox && range.text.length > 0;\r\n\t\t};\r\n\r\n\t\t// Overrides definition of _setSelectionRange from _TextBoxMixin (TODO: move to _TextBoxMixin.js?)\r\n\t\tdijit._setSelectionRange = _TextBoxMixin._setSelectionRange = function(/*DomNode*/ element, /*Number?*/ start, /*Number?*/ stop){\r\n\t\t\tif(element.createTextRange){\r\n\t\t\t\tvar r = element.createTextRange();\r\n\t\t\t\tr.collapse(true);\r\n\t\t\t\tr.moveStart(\"character\", -99999); // move to 0\r\n\t\t\t\tr.moveStart(\"character\", start); // delta from 0 is the correct position\r\n\t\t\t\tr.moveEnd(\"character\", stop-start);\r\n\t\t\t\tr.select();\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tif(has(\"dojo-bidi\")){\r\n\t\tTextBox = declare(\"dijit.form.TextBox\", TextBox, {\r\n\t\t\t_setPlaceHolderAttr: function(v){\r\n\t\t\t\tthis.inherited(arguments);\r\n\t\t\t\tthis.applyTextDir(this._phspan);\r\n\t\t\t}\r\n\t\t});\r\n\t}\r\n\r\n\treturn TextBox;\r\n});\r\n"]}